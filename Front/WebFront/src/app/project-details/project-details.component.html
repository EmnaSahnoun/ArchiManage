<div class="project-details-container">
  <app-header [title]="project.name"></app-header>

  <!-- Navigation entre les onglets -->
  <div class="tabs">
    <button (click)="changeTab('details')" [class.active]="selectedTab === 'details'">Détails du projet</button>
    <button (click)="changeTab('phases')" [class.active]="selectedTab === 'phases'">Phases</button>
  </div>

  <!-- Contenu des onglets -->
  <div *ngIf="selectedTab === 'details'" class="tab-content details-content">
    <div class="left-panel">
      <div class="card">
        <h2>Détails du projet</h2>
        <p><strong>Nom :</strong> {{ project.name }}</p>
        <p><strong>Description :</strong> {{ project.description }}</p>
        <p><strong>Date de création :</strong> {{ project.createdAt }}</p>
        <button class="edit-btn">Modifier</button>
      </div>
    </div>

    <div class="right-panel">
      <div class="card">
        <h2>Statistiques</h2>
        <div class="progress-container">
          <svg width="100" height="100">
            <circle cx="50" cy="50" r="40" stroke="#ddd" stroke-width="8" fill="none"></circle>
            <circle cx="50" cy="50" r="40" stroke="#E27D60" stroke-width="8" fill="none"
                    stroke-dasharray="251.2" attr.stroke-dashoffset="{{ progressOffset }}"></circle>
          </svg>
          <div class="progress-text">{{ project.progress }}%</div>
        </div>
      </div>

      <div class="card">
        <h2>Membres du projet</h2>
        <ul>
          <li *ngFor="let member of project.members">{{ member.name }}</li>
        </ul>
      </div>
    </div>
  </div>

  <div *ngIf="selectedTab === 'phases'" class="tab-content">
    <div class="header">
      <h2>Phases</h2>
      <button mat-button class="add-phase">
        <i class="bi bi-plus"></i> Ajouter une phase
      </button>
    </div>
  
    <!-- Affichage des phases dans un tableau -->
    <div *ngIf="project.phases.length > 0" class="phases-table">
      <table>
        <thead>
          <tr>
            <th>Nom de la Phase</th>
            <th>Description</th>
            <th>Date (Début - Fin)</th>
            <th>Nombre de Tâches</th>
            <th>Membres ayant accès</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let phase of project.phases">
            <td>{{ phase.name }}</td>
            <td>{{ phase.description || 'Pas de description' }}</td>
            <td>{{ phase.startDate }} - {{ phase.endDate }}</td>
            <td>{{ phase.tasks.length }}</td>
            
            <td>
              <div class="members-container">
                <div class="members">
                  <ng-container *ngIf="phase.members.length > 2; else allMembers">
                    <img *ngFor="let member of phase.members.slice(0, 2)" 
                         [src]="member.image" 
                         [alt]="member.name" 
                         class="member-img">
                    <div class="more-members">+{{ phase.members.length - 2 }}</div>
                  </ng-container>
            
                  <ng-template #allMembers>
                    <img *ngFor="let member of phase.members" 
                         [src]="member.image" 
                         [alt]="member.name" 
                         class="member-img">
                  </ng-template>
                </div>
            
                <button (click)="openMemberModal(phase)" class="add-member-btn">
                  <i class="bi bi-plus-circle icon"></i>
                </button>
              </div>
            </td>
            
            
        
            <td>
              <button mat-icon-button (click)="editPhase(phase)">
                <i class="bi bi-pencil icon"></i>
              </button>
              <button mat-icon-button (click)="deletePhase(phase)">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
        
      </table>
    </div>
  
    <div *ngIf="project.phases.length === 0">
      <p>Aucune phase disponible pour ce projet.</p>
    </div>
  </div>
  
  
</div>
