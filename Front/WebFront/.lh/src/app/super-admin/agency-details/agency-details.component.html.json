{
    "sourceFile": "src/app/super-admin/agency-details/agency-details.component.html",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 62,
            "patches": [
                {
                    "date": 1744030048029,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1744030265165,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,9 +39,12 @@\n               <th>Actions</th>\r\n             </tr>\r\n           </thead>\r\n           <tbody>\r\n-            <tr *ngFor=\"let user of users\">\r\n+            <tr *ngFor=\"let agency of filteredAgencies; let i = index\" \r\n+    [class.even]=\"i % 2 === 0\" \r\n+    [class.odd]=\"i % 2 !== 0\"\r\n+    (click)=\"showAgencyDetails(agency)\">\r\n               <td>{{ user.name }}</td>\r\n               <td>{{ user.email }}</td>\r\n               <td>{{ user.role }}</td>\r\n               <td class=\"actions\">\r\n"
                },
                {
                    "date": 1744030337083,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -39,12 +39,9 @@\n               <th>Actions</th>\r\n             </tr>\r\n           </thead>\r\n           <tbody>\r\n-            <tr *ngFor=\"let agency of filteredAgencies; let i = index\" \r\n-    [class.even]=\"i % 2 === 0\" \r\n-    [class.odd]=\"i % 2 !== 0\"\r\n-    (click)=\"showAgencyDetails(agency)\">\r\n+            <tr *ngFor=\"let user of users\">\r\n               <td>{{ user.name }}</td>\r\n               <td>{{ user.email }}</td>\r\n               <td>{{ user.role }}</td>\r\n               <td class=\"actions\">\r\n"
                },
                {
                    "date": 1744032977213,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,58 +1,68 @@\n-<div class=\"agency-details-container\">\r\n-    <div class=\"agency-info\">\r\n-      <h2>{{ agency.name }}</h2>\r\n-      <div class=\"info-grid\">\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Adresse:</span>\r\n-          <span class=\"value\">{{ agency.address }}</span>\r\n-        </div>\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Email:</span>\r\n-          <span class=\"value\">{{ agency.email }}</span>\r\n-        </div>\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Téléphone:</span>\r\n-          <span class=\"value\">{{ agency.phone }}</span>\r\n-        </div>\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Date de création:</span>\r\n-          <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n-        </div>\r\n-      </div>\r\n+<div class=\"agency-details-page\">\r\n+    <div class=\"header\">\r\n+      <button mat-button class=\"back-button\" (click)=\"goBack()\">\r\n+        <i class=\"bi bi-arrow-left\"></i> Retour\r\n+      </button>\r\n+      <h1>Détails de l'Agence</h1>\r\n     </div>\r\n   \r\n-    <div class=\"users-section\">\r\n-      <div class=\"users-header\">\r\n-        <h3>Utilisateurs</h3>\r\n-        <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n-          <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n-        </button>\r\n+    <div class=\"agency-details-container\">\r\n+      <!-- Le reste de votre template actuel -->\r\n+      <div class=\"agency-info\">\r\n+        <h2>{{ agency.name }}</h2>\r\n+        <div class=\"info-grid\">\r\n+          <div class=\"info-item\">\r\n+            <span class=\"label\">Adresse:</span>\r\n+            <span class=\"value\">{{ agency.address }}</span>\r\n+          </div>\r\n+          <div class=\"info-item\">\r\n+            <span class=\"label\">Email:</span>\r\n+            <span class=\"value\">{{ agency.email }}</span>\r\n+          </div>\r\n+          <div class=\"info-item\">\r\n+            <span class=\"label\">Téléphone:</span>\r\n+            <span class=\"value\">{{ agency.phone }}</span>\r\n+          </div>\r\n+          <div class=\"info-item\">\r\n+            <span class=\"label\">Date de création:</span>\r\n+            <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n+          </div>\r\n+        </div>\r\n       </div>\r\n   \r\n-      <div class=\"users-table\">\r\n-        <table>\r\n-          <thead>\r\n-            <tr>\r\n-              <th>Nom</th>\r\n-              <th>Email</th>\r\n-              <th>Rôle</th>\r\n-              <th>Actions</th>\r\n-            </tr>\r\n-          </thead>\r\n-          <tbody>\r\n-            <tr *ngFor=\"let user of users\">\r\n-              <td>{{ user.name }}</td>\r\n-              <td>{{ user.email }}</td>\r\n-              <td>{{ user.role }}</td>\r\n-              <td class=\"actions\">\r\n-                <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n-              </td>\r\n-            </tr>\r\n-            <tr *ngIf=\"users.length === 0\">\r\n-              <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé</td>\r\n-            </tr>\r\n-          </tbody>\r\n-        </table>\r\n+      <div class=\"users-section\">\r\n+        <div class=\"users-header\">\r\n+          <h3>Utilisateurs</h3>\r\n+          <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n+            <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n+          </button>\r\n+        </div>\r\n+  \r\n+        <div class=\"users-table\">\r\n+          <table>\r\n+            <thead>\r\n+              <tr>\r\n+                <th>Nom</th>\r\n+                <th>Email</th>\r\n+                <th>Rôle</th>\r\n+                <th>Actions</th>\r\n+              </tr>\r\n+            </thead>\r\n+            <tbody>\r\n+              <tr *ngFor=\"let user of users\">\r\n+                <td>{{ user.name }}</td>\r\n+                <td>{{ user.email }}</td>\r\n+                <td>{{ user.role }}</td>\r\n+                <td class=\"actions\">\r\n+                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n+                </td>\r\n+              </tr>\r\n+              <tr *ngIf=\"users.length === 0\">\r\n+                <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé</td>\r\n+              </tr>\r\n+            </tbody>\r\n+          </table>\r\n+        </div>\r\n       </div>\r\n     </div>\r\n   </div>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1744033081165,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,68 +1,68 @@\n <div class=\"agency-details-page\">\r\n-    <div class=\"header\">\r\n-      <button mat-button class=\"back-button\" (click)=\"goBack()\">\r\n-        <i class=\"bi bi-arrow-left\"></i> Retour\r\n-      </button>\r\n-      <h1>Détails de l'Agence</h1>\r\n-    </div>\r\n-  \r\n-    <div class=\"agency-details-container\">\r\n-      <!-- Le reste de votre template actuel -->\r\n-      <div class=\"agency-info\">\r\n-        <h2>{{ agency.name }}</h2>\r\n-        <div class=\"info-grid\">\r\n-          <div class=\"info-item\">\r\n-            <span class=\"label\">Adresse:</span>\r\n-            <span class=\"value\">{{ agency.address }}</span>\r\n-          </div>\r\n-          <div class=\"info-item\">\r\n-            <span class=\"label\">Email:</span>\r\n-            <span class=\"value\">{{ agency.email }}</span>\r\n-          </div>\r\n-          <div class=\"info-item\">\r\n-            <span class=\"label\">Téléphone:</span>\r\n-            <span class=\"value\">{{ agency.phone }}</span>\r\n-          </div>\r\n-          <div class=\"info-item\">\r\n-            <span class=\"label\">Date de création:</span>\r\n-            <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n-          </div>\r\n+  <div class=\"header\">\r\n+    <button mat-button class=\"back-button\" (click)=\"goBack()\">\r\n+      <i class=\"bi bi-arrow-left\"></i> Retour\r\n+    </button>\r\n+    <h1>Détails de l'Agence</h1>\r\n+  </div>\r\n+\r\n+  <div class=\"agency-details-container\">\r\n+    <!-- Le reste de votre template actuel -->\r\n+    <div class=\"agency-info\">\r\n+      <h2>{{ agency.name }}</h2>\r\n+      <div class=\"info-grid\">\r\n+        <div class=\"info-item\">\r\n+          <span class=\"label\">Adresse:</span>\r\n+          <span class=\"value\">{{ agency.address }}</span>\r\n         </div>\r\n-      </div>\r\n-  \r\n-      <div class=\"users-section\">\r\n-        <div class=\"users-header\">\r\n-          <h3>Utilisateurs</h3>\r\n-          <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n-            <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n-          </button>\r\n+        <div class=\"info-item\">\r\n+          <span class=\"label\">Email:</span>\r\n+          <span class=\"value\">{{ agency.email }}</span>\r\n         </div>\r\n-  \r\n-        <div class=\"users-table\">\r\n-          <table>\r\n-            <thead>\r\n-              <tr>\r\n-                <th>Nom</th>\r\n-                <th>Email</th>\r\n-                <th>Rôle</th>\r\n-                <th>Actions</th>\r\n-              </tr>\r\n-            </thead>\r\n\\ No newline at end of file\n-            <tbody>\r\n-              <tr *ngFor=\"let user of users\">\r\n-                <td>{{ user.name }}</td>\r\n-                <td>{{ user.email }}</td>\r\n-                <td>{{ user.role }}</td>\r\n-                <td class=\"actions\">\r\n-                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n-                </td>\r\n-              </tr>\r\n-              <tr *ngIf=\"users.length === 0\">\r\n-                <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé</td>\r\n-              </tr>\r\n-            </tbody>\r\n-          </table>\r\n+        <div class=\"info-item\">\r\n+          <span class=\"label\">Téléphone:</span>\r\n+          <span class=\"value\">{{ agency.phone }}</span>\r\n         </div>\r\n+        <div class=\"info-item\">\r\n+          <span class=\"label\">Date de création:</span>\r\n+          <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n+        </div>\r\n       </div>\r\n     </div>\r\n-  </div>\n+\r\n+    <div class=\"users-section\">\r\n+      <div class=\"users-header\">\r\n+        <h3>Utilisateurs</h3>\r\n+        <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n+          <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n+        </button>\r\n+      </div>\r\n+\r\n+      <div class=\"users-table\">\r\n+        <table>\r\n+          <thead>\r\n+            <tr>\r\n+              <th>Nom</th>\r\n+              <th>Email</th>\r\n+              <th>Rôle</th>\r\n+              <th>Actions</th>\r\n+            </tr>\r\n+          </thead>\r\n+          <tbody>\r\n+            <tr *ngFor=\"let user of users\">\r\n+              <td>{{ user.name }}</td>\r\n+              <td>{{ user.email }}</td>\r\n+              <td>{{ user.role }}</td>\r\n+              <td class=\"actions\">\r\n+                <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n+              </td>\r\n+            </tr>\r\n+            <tr *ngIf=\"users.length === 0\">\r\n+              <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé</td>\r\n+            </tr>\r\n+          </tbody>\r\n+        </table>\r\n+      </div>\r\n+    </div>\r\n+  </div>\r\n+</div>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1744039798561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,14 +1,5 @@\n-<div class=\"agency-details-page\">\r\n-  <div class=\"header\">\r\n-    <button mat-button class=\"back-button\" (click)=\"goBack()\">\r\n-      <i class=\"bi bi-arrow-left\"></i> Retour\r\n-    </button>\r\n-    <h1>Détails de l'Agence</h1>\r\n-  </div>\r\n-\r\n-  <div class=\"agency-details-container\">\r\n-    <!-- Le reste de votre template actuel -->\r\n+<div class=\"agency-details-container\">\r\n     <div class=\"agency-info\">\r\n       <h2>{{ agency.name }}</h2>\r\n       <div class=\"info-grid\">\r\n         <div class=\"info-item\">\r\n@@ -28,17 +19,21 @@\n           <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n         </div>\r\n       </div>\r\n     </div>\r\n-\r\n+    <div class=\"actions-section\">\r\n+        <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n+          <i class=\"bi bi-folder\"></i> Voir Projets\r\n+        </button>\r\n+      </div>\r\n     <div class=\"users-section\">\r\n       <div class=\"users-header\">\r\n         <h3>Utilisateurs</h3>\r\n         <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n           <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n         </button>\r\n       </div>\r\n-\r\n+  \r\n       <div class=\"users-table\">\r\n         <table>\r\n           <thead>\r\n             <tr>\r\n@@ -63,6 +58,5 @@\n           </tbody>\r\n         </table>\r\n       </div>\r\n     </div>\r\n-  </div>\r\n-</div>\n\\ No newline at end of file\n+  </div>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1744041588408,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,13 +19,9 @@\n           <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n         </div>\r\n       </div>\r\n     </div>\r\n-    <div class=\"actions-section\">\r\n-        <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n-          <i class=\"bi bi-folder\"></i> Voir Projets\r\n-        </button>\r\n-      </div>\r\n+  \r\n     <div class=\"users-section\">\r\n       <div class=\"users-header\">\r\n         <h3>Utilisateurs</h3>\r\n         <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n"
                },
                {
                    "date": 1744041594498,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,12 @@\n <div class=\"agency-details-container\">\r\n     <div class=\"agency-info\">\r\n       <h2>{{ agency.name }}</h2>\r\n+      <div class=\"actions-section\">\r\n+        <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n+          <i class=\"bi bi-folder\"></i> Voir Projets\r\n+        </button>\r\n+      </div>\r\n       <div class=\"info-grid\">\r\n         <div class=\"info-item\">\r\n           <span class=\"label\">Adresse:</span>\r\n           <span class=\"value\">{{ agency.address }}</span>\r\n"
                },
                {
                    "date": 1744041609400,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n <div class=\"agency-details-container\">\r\n     <div class=\"agency-info\">\r\n-      <h2>{{ agency.name }}</h2>\r\n-      <div class=\"actions-section\">\r\n+      \r\n+      <div class=\"actions-section\"><h2>{{ agency.name }}</h2>\r\n         <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n           <i class=\"bi bi-folder\"></i> Voir Projets\r\n         </button>\r\n       </div>\r\n"
                },
                {
                    "date": 1744041811790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,12 +1,13 @@\n <div class=\"agency-details-container\">\r\n     <div class=\"agency-info\">\r\n       \r\n-      <div class=\"actions-section\"><h2>{{ agency.name }}</h2>\r\n-        <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n-          <i class=\"bi bi-folder\"></i> Voir Projets\r\n-        </button>\r\n-      </div>\r\n+        <div class=\"header-section\">\r\n+            <h2>{{ agency.name }}</h2>\r\n+            <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n+              <i class=\"bi bi-folder\"></i> Voir Projets\r\n+            </button>\r\n+          </div>\r\n       <div class=\"info-grid\">\r\n         <div class=\"info-item\">\r\n           <span class=\"label\">Adresse:</span>\r\n           <span class=\"value\">{{ agency.address }}</span>\r\n"
                },
                {
                    "date": 1745073894608,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,8 @@\n <div class=\"agency-details-container\">\r\n+  <button class=\"close-modal-btn\" (click)=\"closeModal()\">\r\n+    <i class=\"bi bi-x\"></i>\r\n+  </button>\r\n     <div class=\"agency-info\">\r\n       \r\n         <div class=\"header-section\">\r\n             <h2>{{ agency.name }}</h2>\r\n"
                },
                {
                    "date": 1745074162744,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,9 +49,9 @@\n             </tr>\r\n           </thead>\r\n           <tbody>\r\n             <tr *ngFor=\"let user of users\">\r\n-              <td>{{ user.name }}</td>\r\n+              <td>{{ user.username }}</td>\r\n               <td>{{ user.email }}</td>\r\n               <td>{{ user.role }}</td>\r\n               <td class=\"actions\">\r\n                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n"
                },
                {
                    "date": 1745316545194,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n   \r\n     <div class=\"users-section\">\r\n       <div class=\"users-header\">\r\n         <h3>Utilisateurs</h3>\r\n-        <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n+        <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n           <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n         </button>\r\n       </div>\r\n   \r\n"
                },
                {
                    "date": 1745316566608,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n   \r\n     <div class=\"users-section\">\r\n       <div class=\"users-header\">\r\n         <h3>Utilisateurs</h3>\r\n-        <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n+        <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n           <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n         </button>\r\n       </div>\r\n   \r\n"
                },
                {
                    "date": 1745316771379,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n   \r\n     <div class=\"users-section\">\r\n       <div class=\"users-header\">\r\n         <h3>Utilisateurs</h3>\r\n-        <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n+        <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n           <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n         </button>\r\n       </div>\r\n   \r\n"
                },
                {
                    "date": 1745331476157,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,8 +54,11 @@\n               <td>{{ user.email }}</td>\r\n               <td>{{ user.role }}</td>\r\n               <td class=\"actions\">\r\n                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n+                <button class=\"edit-btn\" (click)=\"editAgency(agency); $event.stopPropagation()\">\r\n+                  <i class=\"bi bi-pencil\"></i>\r\n+                </button>\r\n               </td>\r\n             </tr>\r\n             <tr *ngIf=\"users.length === 0\">\r\n               <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé</td>\r\n"
                },
                {
                    "date": 1745331486445,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,9 @@\n               <td>{{ user.email }}</td>\r\n               <td>{{ user.role }}</td>\r\n               <td class=\"actions\">\r\n                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n-                <button class=\"edit-btn\" (click)=\"editAgency(agency); $event.stopPropagation()\">\r\n+                <button class=\"edit-btn\" (click)=\"editUser(agency); $event.stopPropagation()\">\r\n                   <i class=\"bi bi-pencil\"></i>\r\n                 </button>\r\n               </td>\r\n             </tr>\r\n"
                },
                {
                    "date": 1745331500646,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,9 @@\n               <td>{{ user.email }}</td>\r\n               <td>{{ user.role }}</td>\r\n               <td class=\"actions\">\r\n                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n-                <button class=\"edit-btn\" (click)=\"editUser(agency); $event.stopPropagation()\">\r\n+                <button class=\"edit-btn\" (click)=\"editUser(user); >\r\n                   <i class=\"bi bi-pencil\"></i>\r\n                 </button>\r\n               </td>\r\n             </tr>\r\n"
                },
                {
                    "date": 1745331506909,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,9 @@\n               <td>{{ user.email }}</td>\r\n               <td>{{ user.role }}</td>\r\n               <td class=\"actions\">\r\n                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n-                <button class=\"edit-btn\" (click)=\"editUser(user); >\r\n+                <button class=\"edit-btn\" (click)=\"editUser(user) \">\r\n                   <i class=\"bi bi-pencil\"></i>\r\n                 </button>\r\n               </td>\r\n             </tr>\r\n"
                },
                {
                    "date": 1745332408172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,70 +1,113 @@\n <div class=\"agency-details-container\">\r\n-  <button class=\"close-modal-btn\" (click)=\"closeModal()\">\r\n+  <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n     <i class=\"bi bi-x\"></i>\r\n   </button>\r\n-    <div class=\"agency-info\">\r\n-      \r\n-        <div class=\"header-section\">\r\n-            <h2>{{ agency.name }}</h2>\r\n-            <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n-              <i class=\"bi bi-folder\"></i> Voir Projets\r\n-            </button>\r\n-          </div>\r\n-      <div class=\"info-grid\">\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Adresse:</span>\r\n-          <span class=\"value\">{{ agency.address }}</span>\r\n-        </div>\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Email:</span>\r\n-          <span class=\"value\">{{ agency.email }}</span>\r\n-        </div>\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Téléphone:</span>\r\n-          <span class=\"value\">{{ agency.phone }}</span>\r\n-        </div>\r\n-        <div class=\"info-item\">\r\n-          <span class=\"label\">Date de création:</span>\r\n-          <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n-        </div>\r\n+  <div class=\"agency-info\">\r\n+    <div class=\"header-section\">\r\n+      <h2>{{ agency.name }}</h2>\r\n+      <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n+        <i class=\"bi bi-folder\"></i> Voir Projets\r\n+      </button>\r\n+    </div>\r\n+    <div class=\"info-grid\">\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Adresse:</span>\r\n+        <span class=\"value\">{{ agency.address || 'N/A' }}</span>\r\n       </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Email:</span>\r\n+        <span class=\"value\">{{ agency.email || 'N/A' }}</span>\r\n+      </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Téléphone:</span>\r\n+        <span class=\"value\">{{ agency.phone || 'N/A' }}</span>\r\n+      </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Date de création:</span>\r\n+        <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n+      </div>\r\n     </div>\r\n-  \r\n-    <div class=\"users-section\">\r\n-      <div class=\"users-header\">\r\n-        <h3>Utilisateurs</h3>\r\n-        <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n-          <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n-        </button>\r\n-      </div>\r\n-  \r\n-      <div class=\"users-table\">\r\n-        <table>\r\n-          <thead>\r\n-            <tr>\r\n-              <th>Nom</th>\r\n-              <th>Email</th>\r\n\\ No newline at end of file\n-              <th>Rôle</th>\r\n-              <th>Actions</th>\r\n-            </tr>\r\n-          </thead>\r\n-          <tbody>\r\n-            <tr *ngFor=\"let user of users\">\r\n-              <td>{{ user.username }}</td>\r\n-              <td>{{ user.email }}</td>\r\n+  </div>\r\n+\r\n+  <div class=\"users-section\">\r\n+    <div class=\"users-header\">\r\n+      <h3>Utilisateurs</h3>\r\n+      <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n+        <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n+      </button>\r\n+    </div>\r\n+\r\n+    <div class=\"users-table\">\r\n+      <table>\r\n+        <thead>\r\n+          <tr>\r\n+            <th>Nom</th>\r\n+            <th>Email</th>\r\n+            <th>Rôle</th>\r\n+            <th class=\"actions-header\">Actions</th>\r\n+          </tr>\r\n+        </thead>\r\n+        <tbody>\r\n+          <!-- Loading Indicator -->\r\n+          <tr *ngIf=\"isLoadingUsers\">\r\n+            <td colspan=\"4\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n+          </tr>\r\n+\r\n+          <!-- User Rows -->\r\n+          <ng-container *ngIf=\"!isLoadingUsers\">\r\n+            <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n+\r\n+              <!-- Username Column -->\r\n+              <td>\r\n+                <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n+              </td>\r\n+\r\n+              <!-- Email Column -->\r\n+              <td>\r\n+                <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n+              </td>\r\n+\r\n+              <!-- Role Column (Read-only in this example) -->\r\n               <td>{{ user.role }}</td>\r\n+\r\n+              <!-- Actions Column -->\r\n               <td class=\"actions\">\r\n-                <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n-                <button class=\"edit-btn\" (click)=\"editUser(user) \">\r\n-                  <i class=\"bi bi-pencil\"></i>\r\n-                </button>\r\n+                <!-- View/Edit Mode Buttons -->\r\n+                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                    <i class=\"bi bi-pencil\"></i>\r\n+                  </button>\r\n+                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n+                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n+                     <!-- Optional: Show spinner during delete -->\r\n+                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                  </button>\r\n+                </ng-container>\r\n+\r\n+                <!-- Edit Mode Buttons -->\r\n+                <ng-container *ngIf=\"editingUserId === user.id\">\r\n+                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n+                    <!-- Optional: Show spinner during save -->\r\n+                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                  </button>\r\n+                  <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                    <i class=\"bi bi-x-lg\"></i>\r\n+                  </button>\r\n+                </ng-container>\r\n               </td>\r\n             </tr>\r\n-            <tr *ngIf=\"users.length === 0\">\r\n-              <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé</td>\r\n+\r\n+            <!-- No Users Found Row -->\r\n+            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n+              <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n             </tr>\r\n-          </tbody>\r\n-        </table>\r\n-      </div>\r\n+          </ng-container>\r\n+\r\n+        </tbody>\r\n+      </table>\r\n     </div>\r\n-  </div>\n+  </div>\r\n+</div>\r\n"
                },
                {
                    "date": 1745332420200,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,9 +87,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <!-- Optional: Show spinner during save -->\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n"
                },
                {
                    "date": 1745336981341,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,15 +43,17 @@\n           <tr>\r\n             <th>Nom</th>\r\n             <th>Email</th>\r\n             <th>Rôle</th>\r\n+            <th>Statut</th> <!-- Added Header -->\r\n             <th class=\"actions-header\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n           <!-- Loading Indicator -->\r\n           <tr *ngIf=\"isLoadingUsers\">\r\n-            <td colspan=\"4\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n+            <!-- Updated colspan -->\r\n+            <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n           </tr>\r\n \r\n           <!-- User Rows -->\r\n           <ng-container *ngIf=\"!isLoadingUsers\">\r\n@@ -68,11 +70,21 @@\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n                 <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n-              <!-- Role Column (Read-only in this example) -->\r\n+              <!-- Role Column -->\r\n               <td>{{ user.role }}</td>\r\n \r\n+              <!-- Status Column -->\r\n+              <td class=\"status-cell\">\r\n+                <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n+                  <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n+                </span>\r\n+                <span *ngIf=\"!user.enabled\" class=\"status-badge status-disabled\">\r\n+                  <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n+                </span>\r\n+              </td>\r\n+\r\n               <!-- Actions Column -->\r\n               <td class=\"actions\">\r\n                 <!-- View/Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n@@ -80,18 +92,25 @@\n                     <i class=\"bi bi-pencil\"></i>\r\n                   </button>\r\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n-                     <!-- Optional: Show spinner during delete -->\r\n                      <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n+                  <!-- Optional: Add Enable/Disable Button Here -->\r\n+                  <!--\r\n+                  <button *ngIf=\"user.enabled\" class=\"disable-btn\" (click)=\"toggleUserStatus(user, false)\" title=\"Désactiver\">\r\n+                    <i class=\"bi bi-slash-circle\"></i>\r\n+                  </button>\r\n+                  <button *ngIf=\"!user.enabled\" class=\"enable-btn\" (click)=\"toggleUserStatus(user, true)\" title=\"Activer\">\r\n+                    <i class=\"bi bi-check-circle\"></i>\r\n+                  </button>\r\n+                  -->\r\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n-                    <!-- Optional: Show spinner during save -->\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n                     <i class=\"bi bi-x-lg\"></i>\r\n@@ -101,9 +120,10 @@\n             </tr>\r\n \r\n             <!-- No Users Found Row -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+              <!-- Updated colspan -->\r\n+              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n             </tr>\r\n           </ng-container>\r\n \r\n         </tbody>\r\n"
                },
                {
                    "date": 1745336988597,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,9 +107,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"add(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n"
                },
                {
                    "date": 1745337165552,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,22 +94,13 @@\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n                      <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n-                  <!-- Optional: Add Enable/Disable Button Here -->\r\n-                  <!--\r\n-                  <button *ngIf=\"user.enabled\" class=\"disable-btn\" (click)=\"toggleUserStatus(user, false)\" title=\"Désactiver\">\r\n-                    <i class=\"bi bi-slash-circle\"></i>\r\n-                  </button>\r\n-                  <button *ngIf=\"!user.enabled\" class=\"enable-btn\" (click)=\"toggleUserStatus(user, true)\" title=\"Activer\">\r\n-                    <i class=\"bi bi-check-circle\"></i>\r\n-                  </button>\r\n-                  -->\r\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"add(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n"
                },
                {
                    "date": 1745337172947,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,8 +94,17 @@\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n                      <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n+                  <!-- Optional: Add Enable/Disable Button Here -->\r\n+                  <!--\r\n+                  <button *ngIf=\"user.enabled\" class=\"disable-btn\" (click)=\"toggleUserStatus(user, false)\" title=\"Désactiver\">\r\n+                    <i class=\"bi bi-slash-circle\"></i>\r\n+                  </button>\r\n+                  <button *ngIf=\"!user.enabled\" class=\"enable-btn\" (click)=\"toggleUserStatus(user, true)\" title=\"Activer\">\r\n+                    <i class=\"bi bi-check-circle\"></i>\r\n+                  </button>\r\n+                  -->\r\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n"
                },
                {
                    "date": 1745337180058,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,17 +94,8 @@\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n                      <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n-                  <!-- Optional: Add Enable/Disable Button Here -->\r\n-                  <!--\r\n-                  <button *ngIf=\"user.enabled\" class=\"disable-btn\" (click)=\"toggleUserStatus(user, false)\" title=\"Désactiver\">\r\n-                    <i class=\"bi bi-slash-circle\"></i>\r\n-                  </button>\r\n-                  <button *ngIf=\"!user.enabled\" class=\"enable-btn\" (click)=\"toggleUserStatus(user, true)\" title=\"Activer\">\r\n-                    <i class=\"bi bi-check-circle\"></i>\r\n-                  </button>\r\n-                  -->\r\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n"
                },
                {
                    "date": 1745337231658,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,23 +36,24 @@\n         <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n       </button>\r\n     </div>\r\n \r\n+    <!-- ... début du template ... -->\r\n+\r\n     <div class=\"users-table\">\r\n       <table>\r\n         <thead>\r\n           <tr>\r\n             <th>Nom</th>\r\n             <th>Email</th>\r\n             <th>Rôle</th>\r\n-            <th>Statut</th> <!-- Added Header -->\r\n+            <th>Statut</th> <!-- Header reste le même -->\r\n             <th class=\"actions-header\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n           <!-- Loading Indicator -->\r\n           <tr *ngIf=\"isLoadingUsers\">\r\n-            <!-- Updated colspan -->\r\n             <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n           </tr>\r\n \r\n           <!-- User Rows -->\r\n@@ -70,25 +71,41 @@\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n                 <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n-              <!-- Role Column -->\r\n+              <!-- Role Column (Read-only) -->\r\n               <td>{{ user.role }}</td>\r\n \r\n               <!-- Status Column -->\r\n               <td class=\"status-cell\">\r\n-                <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n-                  <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n-                </span>\r\n-                <span *ngIf=\"!user.enabled\" class=\"status-badge status-disabled\">\r\n-                  <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n-                </span>\r\n+                <!-- Display Mode: Badge -->\r\n+                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                  <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n+                    <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n+                  </span>\r\n+                  <span *ngIf=\"!user.enabled\" class=\"status-badge status-disabled\">\r\n+                    <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n+                  </span>\r\n+                </ng-container>\r\n+\r\n+                <!-- Edit Mode: Toggle Switch -->\r\n+                <div *ngIf=\"editingUserId === user.id\" class=\"form-check form-switch d-flex justify-content-center align-items-center h-100\">\r\n+                  <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n+                         id=\"userStatusSwitch-{{user.id}}\"\r\n+                         [(ngModel)]=\"editedUserData.enabled\"\r\n+                         [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n+                  <!-- Optional: Label next to switch -->\r\n+                  <!-- <label class=\"form-check-label ms-2\" for=\"userStatusSwitch-{{user.id}}\">\r\n+                    {{ editedUserData.enabled ? 'Activé' : 'Désactivé' }}\r\n+                  </label> -->\r\n+                </div>\r\n               </td>\r\n \r\n               <!-- Actions Column -->\r\n               <td class=\"actions\">\r\n-                <!-- View/Edit Mode Buttons -->\r\n-                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n+                 <!-- View/Edit Mode Buttons -->\r\n+                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                   <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                     <i class=\"bi bi-pencil\"></i>\r\n                   </button>\r\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n@@ -98,9 +115,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n@@ -111,14 +128,16 @@\n             </tr>\r\n \r\n             <!-- No Users Found Row -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <!-- Updated colspan -->\r\n               <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n             </tr>\r\n           </ng-container>\r\n \r\n         </tbody>\r\n       </table>\r\n     </div>\r\n+\r\n+<!-- ... reste du template ... -->\r\n+\r\n   </div>\r\n </div>\r\n"
                },
                {
                    "date": 1745337247389,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,9 +115,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"add(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n"
                },
                {
                    "date": 1745337286431,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,143 @@\n+<div class=\"agency-details-container\">\r\n+  <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n+    <i class=\"bi bi-x\"></i>\r\n+  </button>\r\n+  <div class=\"agency-info\">\r\n+    <div class=\"header-section\">\r\n+      <h2>{{ agency.name }}</h2>\r\n+      <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n+        <i class=\"bi bi-folder\"></i> Voir Projets\r\n+      </button>\r\n+    </div>\r\n+    <div class=\"info-grid\">\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Adresse:</span>\r\n+        <span class=\"value\">{{ agency.address || 'N/A' }}</span>\r\n+      </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Email:</span>\r\n+        <span class=\"value\">{{ agency.email || 'N/A' }}</span>\r\n+      </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Téléphone:</span>\r\n+        <span class=\"value\">{{ agency.phone || 'N/A' }}</span>\r\n+      </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Date de création:</span>\r\n+        <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n+      </div>\r\n+    </div>\r\n+  </div>\r\n+\r\n+  <div class=\"users-section\">\r\n+    <div class=\"users-header\">\r\n+      <h3>Utilisateurs</h3>\r\n+      <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n+        <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n+      </button>\r\n+    </div>\r\n+\r\n+    <!-- ... début du template ... -->\r\n+\r\n+    <div class=\"users-table\">\r\n+      <table>\r\n+        <thead>\r\n+          <tr>\r\n+            <th>Nom</th>\r\n+            <th>Email</th>\r\n+            <th>Rôle</th>\r\n+            <th>Statut</th> <!-- Header reste le même -->\r\n+            <th class=\"actions-header\">Actions</th>\r\n+          </tr>\r\n+        </thead>\r\n+        <tbody>\r\n+          <!-- Loading Indicator -->\r\n+          <tr *ngIf=\"isLoadingUsers\">\r\n+            <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n+          </tr>\r\n+\r\n+          <!-- User Rows -->\r\n+          <ng-container *ngIf=\"!isLoadingUsers\">\r\n+            <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n+\r\n+              <!-- Username Column -->\r\n+              <td>\r\n+                <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n+              </td>\r\n+\r\n+              <!-- Email Column -->\r\n+              <td>\r\n+                <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n+              </td>\r\n+\r\n+              <!-- Role Column (Read-only) -->\r\n+              <td>{{ user.role }}</td>\r\n+\r\n+              <!-- Status Column -->\r\n+              <td class=\"status-cell\">\r\n+                <!-- Display Mode: Badge -->\r\n+                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                  <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n+                    <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n+                  </span>\r\n+                  <span *ngIf=\"!user.enabled\" class=\"status-badge status-disabled\">\r\n+                    <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n+                  </span>\r\n+                </ng-container>\r\n+\r\n+                <!-- Edit Mode: Toggle Switch -->\r\n+                <div *ngIf=\"editingUserId === user.id\" class=\"form-check form-switch d-flex justify-content-center align-items-center h-100\">\r\n+                  <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n+                         id=\"userStatusSwitch-{{user.id}}\"\r\n+                         [(ngModel)]=\"editedUserData.enabled\"\r\n+                         [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n+                  <!-- Optional: Label next to switch -->\r\n+                  <!-- <label class=\"form-check-label ms-2\" for=\"userStatusSwitch-{{user.id}}\">\r\n+                    {{ editedUserData.enabled ? 'Activé' : 'Désactivé' }}\r\n+                  </label> -->\r\n+                </div>\r\n+              </td>\r\n+\r\n+              <!-- Actions Column -->\r\n+              <td class=\"actions\">\r\n+                <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n+                 <!-- View/Edit Mode Buttons -->\r\n+                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                    <i class=\"bi bi-pencil\"></i>\r\n+                  </button>\r\n+                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n+                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n+                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                  </button>\r\n+                </ng-container>\r\n+\r\n+                <!-- Edit Mode Buttons -->\r\n+                <ng-container *ngIf=\"editingUserId === user.id\">\r\n+                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n+                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                  </button>\r\n+                  <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                    <i class=\"bi bi-x-lg\"></i>\r\n+                  </button>\r\n+                </ng-container>\r\n+              </td>\r\n+            </tr>\r\n+\r\n+            <!-- No Users Found Row -->\r\n+            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n+              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+            </tr>\r\n+          </ng-container>\r\n+\r\n+        </tbody>\r\n+      </table>\r\n+    </div>\r\n+\r\n+<!-- ... reste du template ... -->\r\n+\r\n+  </div>\r\n+</div>\r\n"
                },
                {
                    "date": 1745337306411,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,9 +115,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n@@ -140,147 +140,4 @@\n <!-- ... reste du template ... -->\r\n \r\n   </div>\r\n </div>\r\n-<div class=\"agency-details-container\">\r\n-  <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n-    <i class=\"bi bi-x\"></i>\r\n-  </button>\r\n-  <div class=\"agency-info\">\r\n-    <div class=\"header-section\">\r\n-      <h2>{{ agency.name }}</h2>\r\n-      <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n-        <i class=\"bi bi-folder\"></i> Voir Projets\r\n-      </button>\r\n-    </div>\r\n-    <div class=\"info-grid\">\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Adresse:</span>\r\n-        <span class=\"value\">{{ agency.address || 'N/A' }}</span>\r\n-      </div>\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Email:</span>\r\n-        <span class=\"value\">{{ agency.email || 'N/A' }}</span>\r\n-      </div>\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Téléphone:</span>\r\n-        <span class=\"value\">{{ agency.phone || 'N/A' }}</span>\r\n-      </div>\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Date de création:</span>\r\n-        <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n-      </div>\r\n-    </div>\r\n-  </div>\r\n-\r\n-  <div class=\"users-section\">\r\n-    <div class=\"users-header\">\r\n-      <h3>Utilisateurs</h3>\r\n-      <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n-        <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n-      </button>\r\n-    </div>\r\n-\r\n-    <!-- ... début du template ... -->\r\n-\r\n-    <div class=\"users-table\">\r\n-      <table>\r\n-        <thead>\r\n-          <tr>\r\n-            <th>Nom</th>\r\n-            <th>Email</th>\r\n-            <th>Rôle</th>\r\n-            <th>Statut</th> <!-- Header reste le même -->\r\n-            <th class=\"actions-header\">Actions</th>\r\n-          </tr>\r\n-        </thead>\r\n-        <tbody>\r\n-          <!-- Loading Indicator -->\r\n-          <tr *ngIf=\"isLoadingUsers\">\r\n-            <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n-          </tr>\r\n-\r\n-          <!-- User Rows -->\r\n-          <ng-container *ngIf=\"!isLoadingUsers\">\r\n-            <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n-\r\n-              <!-- Username Column -->\r\n-              <td>\r\n-                <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n-              </td>\r\n-\r\n-              <!-- Email Column -->\r\n-              <td>\r\n-                <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n-              </td>\r\n-\r\n-              <!-- Role Column (Read-only) -->\r\n-              <td>{{ user.role }}</td>\r\n-\r\n-              <!-- Status Column -->\r\n-              <td class=\"status-cell\">\r\n-                <!-- Display Mode: Badge -->\r\n-                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n-                    <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n-                  </span>\r\n-                  <span *ngIf=\"!user.enabled\" class=\"status-badge status-disabled\">\r\n-                    <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n-                  </span>\r\n-                </ng-container>\r\n-\r\n-                <!-- Edit Mode: Toggle Switch -->\r\n-                <div *ngIf=\"editingUserId === user.id\" class=\"form-check form-switch d-flex justify-content-center align-items-center h-100\">\r\n-                  <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n-                         id=\"userStatusSwitch-{{user.id}}\"\r\n-                         [(ngModel)]=\"editedUserData.enabled\"\r\n-                         [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n-                  <!-- Optional: Label next to switch -->\r\n-                  <!-- <label class=\"form-check-label ms-2\" for=\"userStatusSwitch-{{user.id}}\">\r\n-                    {{ editedUserData.enabled ? 'Activé' : 'Désactivé' }}\r\n-                  </label> -->\r\n-                </div>\r\n-              </td>\r\n-\r\n-              <!-- Actions Column -->\r\n-              <td class=\"actions\">\r\n-                <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n-                 <!-- View/Edit Mode Buttons -->\r\n-                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n-                    <i class=\"bi bi-pencil\"></i>\r\n-                  </button>\r\n-                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n-                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n-                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                  </button>\r\n-                </ng-container>\r\n-\r\n-                <!-- Edit Mode Buttons -->\r\n-                <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"add(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n-                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n-                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                  </button>\r\n-                  <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n-                    <i class=\"bi bi-x-lg\"></i>\r\n-                  </button>\r\n-                </ng-container>\r\n-              </td>\r\n-            </tr>\r\n-\r\n-            <!-- No Users Found Row -->\r\n-            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n-            </tr>\r\n-          </ng-container>\r\n-\r\n-        </tbody>\r\n-      </table>\r\n-    </div>\r\n-\r\n-<!-- ... reste du template ... -->\r\n-\r\n-  </div>\r\n-</div>\r\n"
                },
                {
                    "date": 1745338632026,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,9 +104,9 @@\n               <td class=\"actions\">\r\n                 <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n                  <!-- View/Edit Mode Buttons -->\r\n                  <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                  <button class=\"edit-btn\" (click)=\"editUser()\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                     <i class=\"bi bi-pencil\"></i>\r\n                   </button>\r\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n"
                },
                {
                    "date": 1745338684336,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,9 +104,9 @@\n               <td class=\"actions\">\r\n                 <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n                  <!-- View/Edit Mode Buttons -->\r\n                  <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <button class=\"edit-btn\" (click)=\"editUser()\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                     <i class=\"bi bi-pencil\"></i>\r\n                   </button>\r\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n"
                },
                {
                    "date": 1745338770962,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,9 +104,9 @@\n               <td class=\"actions\">\r\n                 <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n                  <!-- View/Edit Mode Buttons -->\r\n                  <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" >\r\n                     <i class=\"bi bi-pencil\"></i>\r\n                   </button>\r\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n"
                },
                {
                    "date": 1745338818689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,9 +104,9 @@\n               <td class=\"actions\">\r\n                 <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n                  <!-- View/Edit Mode Buttons -->\r\n                  <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" >\r\n+                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                     <i class=\"bi bi-pencil\"></i>\r\n                   </button>\r\n                   <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n                      <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n@@ -115,9 +115,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"add(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n"
                },
                {
                    "date": 1745338921120,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,9 +115,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"add(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n"
                },
                {
                    "date": 1745338926626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -115,9 +115,9 @@\n                 </ng-container>\r\n \r\n                 <!-- Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"saveUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n                     <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n                     <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                   </button>\r\n                   <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n"
                },
                {
                    "date": 1745357055247,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,12 +92,9 @@\n                   <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n                          id=\"userStatusSwitch-{{user.id}}\"\r\n                          [(ngModel)]=\"editedUserData.enabled\"\r\n                          [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n-                  <!-- Optional: Label next to switch -->\r\n-                  <!-- <label class=\"form-check-label ms-2\" for=\"userStatusSwitch-{{user.id}}\">\r\n-                    {{ editedUserData.enabled ? 'Activé' : 'Désactivé' }}\r\n-                  </label> -->\r\n+                \r\n                 </div>\r\n               </td>\r\n \r\n               <!-- Actions Column -->\r\n"
                },
                {
                    "date": 1745357069266,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,32 +97,40 @@\n                 </div>\r\n               </td>\r\n \r\n               <!-- Actions Column -->\r\n+              <!-- ... other parts of the template ... -->\r\n+\r\n+              <!-- Actions Column -->\r\n               <td class=\"actions\">\r\n-                <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n-                 <!-- View/Edit Mode Buttons -->\r\n-                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n-                    <i class=\"bi bi-pencil\"></i>\r\n-                  </button>\r\n-                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n-                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n-                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                  </button>\r\n-                </ng-container>\r\n+                <!-- View/Edit Mode Buttons -->\r\n+                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                   <i class=\"bi bi-pencil\"></i>\r\n+                 </button>\r\n+                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Disable delete also when editing any user -->\r\n+                    <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n+                    <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                 </button>\r\n+               </ng-container>\r\n \r\n-                <!-- Edit Mode Buttons -->\r\n-                <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n-                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n-                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                  </button>\r\n-                  <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n-                    <i class=\"bi bi-x-lg\"></i>\r\n-                  </button>\r\n-                </ng-container>\r\n-              </td>\r\n+               <!-- Edit Mode Buttons -->\r\n+               <ng-container *ngIf=\"editingUserId === user.id\">\r\n+                 <!-- **** THIS IS THE IMPORTANT CHANGE **** -->\r\n+                 <button class=\"save-btn\" (click)=\"saveUser()\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                 <!-- **** END OF IMPORTANT CHANGE **** -->\r\n+                   <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n+                   <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                 </button>\r\n+                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                   <i class=\"bi bi-x-lg\"></i>\r\n+                 </button>\r\n+               </ng-container>\r\n+             </td>\r\n+           </tr>\r\n+\r\n+<!-- ... rest of the template ... -->\r\n+\r\n             </tr>\r\n \r\n             <!-- No Users Found Row -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n"
                },
                {
                    "date": 1745357080538,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,45 +92,40 @@\n                   <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n                          id=\"userStatusSwitch-{{user.id}}\"\r\n                          [(ngModel)]=\"editedUserData.enabled\"\r\n                          [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n-                \r\n+                  <!-- Optional: Label next to switch -->\r\n+                  <!-- <label class=\"form-check-label ms-2\" for=\"userStatusSwitch-{{user.id}}\">\r\n+                    {{ editedUserData.enabled ? 'Activé' : 'Désactivé' }}\r\n+                  </label> -->\r\n                 </div>\r\n               </td>\r\n \r\n               <!-- Actions Column -->\r\n-              <!-- ... other parts of the template ... -->\r\n-\r\n-              <!-- Actions Column -->\r\n               <td class=\"actions\">\r\n-                <!-- View/Edit Mode Buttons -->\r\n-                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n-                   <i class=\"bi bi-pencil\"></i>\r\n-                 </button>\r\n-                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Disable delete also when editing any user -->\r\n-                    <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n-                    <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                 </button>\r\n-               </ng-container>\r\n+                <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n+                 <!-- View/Edit Mode Buttons -->\r\n+                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                    <i class=\"bi bi-pencil\"></i>\r\n+                  </button>\r\n+                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n+                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n+                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                  </button>\r\n+                </ng-container>\r\n \r\n-               <!-- Edit Mode Buttons -->\r\n-               <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                 <!-- **** THIS IS THE IMPORTANT CHANGE **** -->\r\n-                 <button class=\"save-btn\" (click)=\"saveUser()\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n-                 <!-- **** END OF IMPORTANT CHANGE **** -->\r\n-                   <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n-                   <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                 </button>\r\n-                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n-                   <i class=\"bi bi-x-lg\"></i>\r\n-                 </button>\r\n-               </ng-container>\r\n-             </td>\r\n-           </tr>\r\n-\r\n-<!-- ... rest of the template ... -->\r\n-\r\n+                <!-- Edit Mode Buttons -->\r\n+                <ng-container *ngIf=\"editingUserId === user.id\">\r\n+                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n+                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                  </button>\r\n+                  <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                    <i class=\"bi bi-x-lg\"></i>\r\n+                  </button>\r\n+                </ng-container>\r\n+              </td>\r\n             </tr>\r\n \r\n             <!-- No Users Found Row -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n"
                },
                {
                    "date": 1745357089565,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,19 +92,14 @@\n                   <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n                          id=\"userStatusSwitch-{{user.id}}\"\r\n                          [(ngModel)]=\"editedUserData.enabled\"\r\n                          [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n-                  <!-- Optional: Label next to switch -->\r\n-                  <!-- <label class=\"form-check-label ms-2\" for=\"userStatusSwitch-{{user.id}}\">\r\n-                    {{ editedUserData.enabled ? 'Activé' : 'Désactivé' }}\r\n-                  </label> -->\r\n+                 \r\n                 </div>\r\n               </td>\r\n \r\n               <!-- Actions Column -->\r\n               <td class=\"actions\">\r\n-                <!-- ... (les boutons restent les mêmes que dans la réponse précédente) ... -->\r\n-                 <!-- View/Edit Mode Buttons -->\r\n                  <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                   <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                     <i class=\"bi bi-pencil\"></i>\r\n                   </button>\r\n"
                },
                {
                    "date": 1745357101928,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,30 +97,9 @@\n                 </div>\r\n               </td>\r\n \r\n               <!-- Actions Column -->\r\n-              <td class=\"actions\">\r\n-                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n-                    <i class=\"bi bi-pencil\"></i>\r\n-                  </button>\r\n-                  <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id\">\r\n-                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n-                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                  </button>\r\n-                </ng-container>\r\n-\r\n-                <!-- Edit Mode Buttons -->\r\n-                <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                  <button class=\"save-btn\" (click)=\"addUser(user)\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n-                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n-                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                  </button>\r\n-                  <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n-                    <i class=\"bi bi-x-lg\"></i>\r\n-                  </button>\r\n-                </ng-container>\r\n-              </td>\r\n+              \r\n             </tr>\r\n \r\n             <!-- No Users Found Row -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n"
                },
                {
                    "date": 1745357113991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,11 +97,41 @@\n                 </div>\r\n               </td>\r\n \r\n               <!-- Actions Column -->\r\n-              \r\n-            </tr>\r\n+              <!-- ... other parts of the template ... -->\r\n \r\n+              <!-- Actions Column -->\r\n+              <td class=\"actions\">\r\n+                <!-- View/Edit Mode Buttons -->\r\n+                <ng-container *ngIf=\"editingUserId !== user.id\">\r\n+                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                   <i class=\"bi bi-pencil\"></i>\r\n+                 </button>\r\n+                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Disable delete also when editing any user -->\r\n+                    <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n+                    <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                 </button>\r\n+               </ng-container>\r\n+\r\n+               <!-- Edit Mode Buttons -->\r\n+               <ng-container *ngIf=\"editingUserId === user.id\">\r\n+                 <!-- **** THIS IS THE IMPORTANT CHANGE **** -->\r\n+                 <button class=\"save-btn\" (click)=\"saveUser()\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                 <!-- **** END OF IMPORTANT CHANGE **** -->\r\n+                   <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n+                   <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                 </button>\r\n+                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                   <i class=\"bi bi-x-lg\"></i>\r\n+                 </button>\r\n+               </ng-container>\r\n+             </td>\r\n+           </tr>\r\n+\r\n+<!-- ... rest of the template ... -->\r\n+\r\n+\r\n             <!-- No Users Found Row -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n               <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n             </tr>\r\n"
                },
                {
                    "date": 1745510440656,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,9 +56,9 @@\n             <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n           </tr>\r\n \r\n           <!-- User Rows -->\r\n-          <ng-container *ngIf=\"!isLoadingUsers\">\r\n+          <ng-container *ngIf=\"users\">\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n               <!-- Username Column -->\r\n               <td>\r\n"
                },
                {
                    "date": 1745510517745,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -56,9 +56,9 @@\n             <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n           </tr>\r\n \r\n           <!-- User Rows -->\r\n-          <ng-container *ngIf=\"users\">\r\n+          <ng-container *ngIf=\"users.length > 0\">\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n               <!-- Username Column -->\r\n               <td>\r\n@@ -130,12 +130,9 @@\n \r\n <!-- ... rest of the template ... -->\r\n \r\n \r\n-            <!-- No Users Found Row -->\r\n-            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n-            </tr>\r\n+            \r\n           </ng-container>\r\n \r\n         </tbody>\r\n       </table>\r\n"
                },
                {
                    "date": 1745510532096,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -130,9 +130,12 @@\n \r\n <!-- ... rest of the template ... -->\r\n \r\n \r\n-            \r\n+            <!-- No Users Found Row -->\r\n+            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n+              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+            </tr>\r\n           </ng-container>\r\n \r\n         </tbody>\r\n       </table>\r\n"
                },
                {
                    "date": 1745510540355,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -57,8 +57,12 @@\n           </tr>\r\n \r\n           <!-- User Rows -->\r\n           <ng-container *ngIf=\"users.length > 0\">\r\n+            <!-- No Users Found Row -->\r\n+            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n+              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+            </tr>\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n               <!-- Username Column -->\r\n               <td>\r\n@@ -130,12 +134,9 @@\n \r\n <!-- ... rest of the template ... -->\r\n \r\n \r\n-            <!-- No Users Found Row -->\r\n-            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n-            </tr>\r\n+            \r\n           </ng-container>\r\n \r\n         </tbody>\r\n       </table>\r\n"
                },
                {
                    "date": 1745510567260,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n             </tr>\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n               <!-- Username Column -->\r\n-              <td>\r\n+              <td class=\"\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n                 <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n"
                },
                {
                    "date": 1745510574558,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,9 @@\n             </tr>\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n               <!-- Username Column -->\r\n-              <td class=\"\">\r\n+              <td class=\"text-c\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n                 <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n"
                },
                {
                    "date": 1745510604117,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -42,9 +42,9 @@\n     <div class=\"users-table\">\r\n       <table>\r\n         <thead>\r\n           <tr>\r\n-            <th>Nom</th>\r\n+            <th class=\"text-center\">Nom</th>\r\n             <th>Email</th>\r\n             <th>Rôle</th>\r\n             <th>Statut</th> <!-- Header reste le même -->\r\n             <th class=\"actions-header\">Actions</th>\r\n@@ -64,9 +64,9 @@\n             </tr>\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n               <!-- Username Column -->\r\n-              <td class=\"text-c\">\r\n+              <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n                 <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n"
                },
                {
                    "date": 1745510610718,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,10 +43,10 @@\n       <table>\r\n         <thead>\r\n           <tr>\r\n             <th class=\"text-center\">Nom</th>\r\n-            <th>Email</th>\r\n-            <th>Rôle</th>\r\n+            <th class=\"text-center\">Email</th>\r\n+            <thc lass=\"text-center\">Rôle</th>\r\n             <th>Statut</th> <!-- Header reste le même -->\r\n             <th class=\"actions-header\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n"
                },
                {
                    "date": 1745510616250,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -44,10 +44,10 @@\n         <thead>\r\n           <tr>\r\n             <th class=\"text-center\">Nom</th>\r\n             <th class=\"text-center\">Email</th>\r\n-            <thc lass=\"text-center\">Rôle</th>\r\n-            <th>Statut</th> <!-- Header reste le même -->\r\n+            <th class=\"text-center\">Rôle</th>\r\n+            <th class=\"text-center\">Statut</th> <!-- Header reste le même -->\r\n             <th class=\"actions-header\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n"
                },
                {
                    "date": 1745510624303,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n             <th class=\"text-center\">Nom</th>\r\n             <th class=\"text-center\">Email</th>\r\n             <th class=\"text-center\">Rôle</th>\r\n             <th class=\"text-center\">Statut</th> <!-- Header reste le même -->\r\n-            <th class=\"actions-header\">Actions</th>\r\n+            <th class=\"actions-header text-center\"\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n           <!-- Loading Indicator -->\r\n"
                },
                {
                    "date": 1745510684187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,9 +46,9 @@\n             <th class=\"text-center\">Nom</th>\r\n             <th class=\"text-center\">Email</th>\r\n             <th class=\"text-center\">Rôle</th>\r\n             <th class=\"text-center\">Statut</th> <!-- Header reste le même -->\r\n-            <th class=\"actions-header text-center\"\">Actions</th>\r\n+            <th class=\"actions-header text-center\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n           <!-- Loading Indicator -->\r\n@@ -70,9 +70,9 @@\n                 <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n               <!-- Email Column -->\r\n-              <td>\r\n+              <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n                 <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n"
                },
                {
                    "date": 1745510692174,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,12 +76,12 @@\n                 <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n               <!-- Role Column (Read-only) -->\r\n-              <td>{{ user.role }}</td>\r\n+              <td class=\"text-center\">{{ user.role }}</td>\r\n \r\n               <!-- Status Column -->\r\n-              <td class=\"status-cell\">\r\n+              <td class=\"status-cell class=\"text-center\"\">\r\n                 <!-- Display Mode: Badge -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                   <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n                     <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n"
                },
                {
                    "date": 1745510731171,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,9 +79,9 @@\n               <!-- Role Column (Read-only) -->\r\n               <td class=\"text-center\">{{ user.role }}</td>\r\n \r\n               <!-- Status Column -->\r\n-              <td class=\"status-cell class=\"text-center\"\">\r\n+              <td class=\"status-cell text-center\">\r\n                 <!-- Display Mode: Badge -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                   <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n                     <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n@@ -104,9 +104,9 @@\n               <!-- Actions Column -->\r\n               <!-- ... other parts of the template ... -->\r\n \r\n               <!-- Actions Column -->\r\n-              <td class=\"actions\">\r\n+              <td class=\"actions \">\r\n                 <!-- View/Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                    <i class=\"bi bi-pencil\"></i>\r\n"
                },
                {
                    "date": 1745510737039,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -104,9 +104,9 @@\n               <!-- Actions Column -->\r\n               <!-- ... other parts of the template ... -->\r\n \r\n               <!-- Actions Column -->\r\n-              <td class=\"actions \">\r\n+              <td class=\"actions text-center\">\r\n                 <!-- View/Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                  <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                    <i class=\"bi bi-pencil\"></i>\r\n"
                },
                {
                    "date": 1745510746904,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,10 +100,8 @@\n                  \r\n                 </div>\r\n               </td>\r\n \r\n-              <!-- Actions Column -->\r\n-              <!-- ... other parts of the template ... -->\r\n \r\n               <!-- Actions Column -->\r\n               <td class=\"actions text-center\">\r\n                 <!-- View/Edit Mode Buttons -->\r\n"
                },
                {
                    "date": 1745517198923,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,146 +1,137 @@\n <div class=\"agency-details-container\">\r\n+  <!-- Bouton Fermer -->\r\n   <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n-    <i class=\"bi bi-x\"></i>\r\n+    <i class=\"bi bi-x-lg\"></i> <!-- Icône plus visible -->\r\n   </button>\r\n-  <div class=\"agency-info\">\r\n-    <div class=\"header-section\">\r\n-      <h2>{{ agency.name }}</h2>\r\n-      <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n-        <i class=\"bi bi-folder\"></i> Voir Projets\r\n-      </button>\r\n-    </div>\r\n-    <div class=\"info-grid\">\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Adresse:</span>\r\n-        <span class=\"value\">{{ agency.address || 'N/A' }}</span>\r\n+\r\n+  <!-- Informations sur l'agence -->\r\n+  <div class=\"agency-info card mb-4\"> <!-- Utilisation de classes Bootstrap card -->\r\n+    <div class=\"card-body\">\r\n+      <div class=\"header-section d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom\">\r\n+        <h2 class=\"card-title mb-0\">{{ agency?.name || 'Détails Agence' }}</h2> <!-- Utiliser optional chaining -->\r\n+        <button mat-flat-button color=\"primary\" class=\"projects-btn\" (click)=\"viewProjects()\"> <!-- Utiliser mat-flat-button -->\r\n+          <mat-icon>folder</mat-icon> Voir Projets <!-- Utiliser mat-icon -->\r\n+        </button>\r\n       </div>\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Email:</span>\r\n-        <span class=\"value\">{{ agency.email || 'N/A' }}</span>\r\n+      <div class=\"info-grid row\"> <!-- Utilisation de row/col Bootstrap pour la grille -->\r\n+        <div class=\"info-item col-md-6 mb-2\">\r\n+          <span class=\"label d-block\">Adresse:</span>\r\n+          <span class=\"value\">{{ agency?.address || 'N/A' }}</span>\r\n+        </div>\r\n+        <div class=\"info-item col-md-6 mb-2\">\r\n+          <span class=\"label d-block\">Email:</span>\r\n+          <span class=\"value\">{{ agency?.email || 'N/A' }}</span>\r\n+        </div>\r\n+        <div class=\"info-item col-md-6 mb-2\">\r\n+          <span class=\"label d-block\">Téléphone:</span>\r\n+          <span class=\"value\">{{ agency?.phone || 'N/A' }}</span>\r\n+        </div>\r\n+        <div class=\"info-item col-md-6 mb-2\">\r\n+          <span class=\"label d-block\">Date de création:</span>\r\n+          <span class=\"value\">{{ agency?.createdAt | date:'dd/MM/yyyy HH:mm' }}</span> <!-- Ajout heure -->\r\n+        </div>\r\n       </div>\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Téléphone:</span>\r\n-        <span class=\"value\">{{ agency.phone || 'N/A' }}</span>\r\n-      </div>\r\n-      <div class=\"info-item\">\r\n-        <span class=\"label\">Date de création:</span>\r\n-        <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n-      </div>\r\n     </div>\r\n   </div>\r\n \r\n-  <div class=\"users-section\">\r\n-    <div class=\"users-header\">\r\n-      <h3>Utilisateurs</h3>\r\n-      <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n-        <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n-      </button>\r\n-    </div>\r\n+  <!-- Section Utilisateurs -->\r\n+  <div class=\"users-section card\"> <!-- Utilisation de classes Bootstrap card -->\r\n+    <div class=\"card-body\">\r\n+      <div class=\"users-header d-flex justify-content-between align-items-center mb-3\">\r\n+        <h3 class=\"mb-0\">Utilisateurs</h3>\r\n+        <button mat-flat-button color=\"accent\" class=\"add-user-btn\" (click)=\"addUser()\" [disabled]=\"isLoadingUsers || !!editingUserId\"> <!-- Utiliser mat-flat-button, désactiver si édition -->\r\n+          <mat-icon>person_add</mat-icon> Ajouter Utilisateur <!-- Utiliser mat-icon -->\r\n+        </button>\r\n+      </div>\r\n \r\n-    <!-- ... début du template ... -->\r\n+      <!-- Indicateur de chargement des utilisateurs -->\r\n+      <div *ngIf=\"isLoadingUsers\" class=\"text-center my-4\">\r\n+        <mat-progress-spinner mode=\"indeterminate\" diameter=\"40\"></mat-progress-spinner> <!-- Utiliser mat-progress-spinner -->\r\n+        <p class=\"mt-2\">Chargement des utilisateurs...</p>\r\n+      </div>\r\n \r\n-    <div class=\"users-table\">\r\n-      <table>\r\n-        <thead>\r\n-          <tr>\r\n-            <th class=\"text-center\">Nom</th>\r\n-            <th class=\"text-center\">Email</th>\r\n-            <th class=\"text-center\">Rôle</th>\r\n-            <th class=\"text-center\">Statut</th> <!-- Header reste le même -->\r\n-            <th class=\"actions-header text-center\">Actions</th>\r\n-          </tr>\r\n-        </thead>\r\n-        <tbody>\r\n-          <!-- Loading Indicator -->\r\n-          <tr *ngIf=\"isLoadingUsers\">\r\n-            <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n-          </tr>\r\n-\r\n-          <!-- User Rows -->\r\n-          <ng-container *ngIf=\"users.length > 0\">\r\n-            <!-- No Users Found Row -->\r\n+      <!-- Tableau des utilisateurs -->\r\n+      <div class=\"users-table table-responsive\" *ngIf=\"!isLoadingUsers\"> <!-- table-responsive pour petits écrans -->\r\n+        <table class=\"table table-hover\"> <!-- Utilisation de classes Bootstrap table -->\r\n+          <thead>\r\n+            <tr>\r\n+              <th class=\"text-center\">Nom</th>\r\n+              <th class=\"text-center\">Email</th>\r\n+              <th class=\"text-center\">Rôle</th>\r\n+              <th class=\"text-center\">Statut</th>\r\n+              <th class=\"actions-header text-center\">Actions</th>\r\n+            </tr>\r\n+          </thead>\r\n+          <tbody>\r\n+            <!-- Message si aucun utilisateur -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+              <td colspan=\"5\" class=\"text-center no-users py-4\">Aucun utilisateur trouvé pour cette agence.</td>\r\n             </tr>\r\n-            <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n-              <!-- Username Column -->\r\n-              <td class=\"text-center\">\r\n+            <!-- Lignes des utilisateurs -->\r\n+            <tr *ngFor=\"let user of users\" [class.table-info]=\"editingUserId === user.id\"> <!-- Classe Bootstrap pour ligne éditée -->\r\n+\r\n+              <!-- Colonne Nom -->\r\n+              <td class=\"text-center align-middle\"> <!-- align-middle pour alignement vertical -->\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"form-control form-control-sm inline-edit-input\" /> <!-- form-control Bootstrap -->\r\n               </td>\r\n \r\n-              <!-- Email Column -->\r\n-              <td class=\"text-center\">\r\n+              <!-- Colonne Email -->\r\n+              <td class=\"text-center align-middle\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"form-control form-control-sm inline-edit-input\" />\r\n               </td>\r\n \r\n-              <!-- Role Column (Read-only) -->\r\n-              <td class=\"text-center\">{{ user.role }}</td>\r\n+              <!-- Colonne Rôle (Lecture seule) -->\r\n+              <td class=\"text-center align-middle\">{{ user.role }}</td>\r\n \r\n-              <!-- Status Column -->\r\n-              <td class=\"status-cell text-center\">\r\n-                <!-- Display Mode: Badge -->\r\n+              <!-- Colonne Statut -->\r\n+              <td class=\"status-cell text-center align-middle\">\r\n+                <!-- Mode Affichage: Badge -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n-                    <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n+                  <span class=\"badge rounded-pill\" [ngClass]=\"user.enabled ? 'text-bg-success' : 'text-bg-danger'\"> <!-- Badges Bootstrap -->\r\n+                    <i class=\"bi me-1\" [ngClass]=\"user.enabled ? 'bi-check-circle-fill' : 'bi-x-circle-fill'\"></i>\r\n+                    {{ user.enabled ? 'Activé' : 'Désactivé' }}\r\n                   </span>\r\n-                  <span *ngIf=\"!user.enabled\" class=\"status-badge status-disabled\">\r\n-                    <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n-                  </span>\r\n                 </ng-container>\r\n-\r\n-                <!-- Edit Mode: Toggle Switch -->\r\n+                <!-- Mode Édition: Toggle Switch Bootstrap -->\r\n                 <div *ngIf=\"editingUserId === user.id\" class=\"form-check form-switch d-flex justify-content-center align-items-center h-100\">\r\n                   <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n                          id=\"userStatusSwitch-{{user.id}}\"\r\n                          [(ngModel)]=\"editedUserData.enabled\"\r\n-                         [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n-                 \r\n+                         [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver' : 'Activer'\">\r\n                 </div>\r\n               </td>\r\n \r\n-\r\n-              <!-- Actions Column -->\r\n-              <td class=\"actions text-center\">\r\n-                <!-- View/Edit Mode Buttons -->\r\n+              <!-- Colonne Actions -->\r\n+              <td class=\"actions text-center align-middle\">\r\n+                <!-- Boutons Mode Affichage/Édition -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n-                   <i class=\"bi bi-pencil\"></i>\r\n+                 <button mat-icon-button color=\"primary\" class=\"edit-btn\" (click)=\"editUser(user)\" matTooltip=\"Modifier\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Utiliser mat-icon-button -->\r\n+                   <mat-icon>edit</mat-icon>\r\n                  </button>\r\n-                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Disable delete also when editing any user -->\r\n-                    <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n-                    <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                 <button mat-icon-button color=\"warn\" class=\"delete-btn\" (click)=\"deleteUser(user)\" matTooltip=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\">\r\n+                    <mat-icon *ngIf=\"isDeletingUser !== user.id\">delete_outline</mat-icon>\r\n+                    <mat-spinner *ngIf=\"isDeletingUser === user.id\" [diameter]=\"20\"></mat-spinner> <!-- Utiliser mat-spinner -->\r\n                  </button>\r\n                </ng-container>\r\n \r\n-               <!-- Edit Mode Buttons -->\r\n+               <!-- Boutons Mode Sauvegarde/Annulation -->\r\n                <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                 <!-- **** THIS IS THE IMPORTANT CHANGE **** -->\r\n-                 <button class=\"save-btn\" (click)=\"saveUser()\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n-                 <!-- **** END OF IMPORTANT CHANGE **** -->\r\n-                   <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n-                   <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                 <button mat-icon-button color=\"accent\" class=\"save-btn\" (click)=\"saveUser()\" matTooltip=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                   <mat-icon *ngIf=\"!isSavingUser\">check</mat-icon>\r\n+                   <mat-spinner *ngIf=\"isSavingUser\" [diameter]=\"20\"></mat-spinner>\r\n                  </button>\r\n-                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n-                   <i class=\"bi bi-x-lg\"></i>\r\n+                 <button mat-icon-button class=\"cancel-btn\" (click)=\"cancelEdit()\" matTooltip=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                   <mat-icon>close</mat-icon>\r\n                  </button>\r\n                </ng-container>\r\n              </td>\r\n            </tr>\r\n-\r\n-<!-- ... rest of the template ... -->\r\n-\r\n-\r\n-            \r\n-          </ng-container>\r\n-\r\n-        </tbody>\r\n-      </table>\r\n+          </tbody>\r\n+        </table>\r\n+      </div>\r\n     </div>\r\n-\r\n-<!-- ... reste du template ... -->\r\n-\r\n   </div>\r\n </div>\r\n"
                },
                {
                    "date": 1745517487808,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,137 +1,146 @@\n <div class=\"agency-details-container\">\r\n-  <!-- Bouton Fermer -->\r\n   <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n-    <i class=\"bi bi-x-lg\"></i> <!-- Icône plus visible -->\r\n+    <i class=\"bi bi-x\"></i>\r\n   </button>\r\n-\r\n-  <!-- Informations sur l'agence -->\r\n-  <div class=\"agency-info card mb-4\"> <!-- Utilisation de classes Bootstrap card -->\r\n-    <div class=\"card-body\">\r\n-      <div class=\"header-section d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom\">\r\n-        <h2 class=\"card-title mb-0\">{{ agency?.name || 'Détails Agence' }}</h2> <!-- Utiliser optional chaining -->\r\n-        <button mat-flat-button color=\"primary\" class=\"projects-btn\" (click)=\"viewProjects()\"> <!-- Utiliser mat-flat-button -->\r\n-          <mat-icon>folder</mat-icon> Voir Projets <!-- Utiliser mat-icon -->\r\n-        </button>\r\n+  <div class=\"agency-info\">\r\n+    <div class=\"header-section\">\r\n+      <h2>{{ agency.name }}</h2>\r\n+      <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n+        <i class=\"bi bi-folder\"></i> Voir Projets\r\n+      </button>\r\n+    </div>\r\n+    <div class=\"info-grid\">\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Adresse:</span>\r\n+        <span class=\"value\">{{ agency.address || 'N/A' }}</span>\r\n       </div>\r\n-      <div class=\"info-grid row\"> <!-- Utilisation de row/col Bootstrap pour la grille -->\r\n-        <div class=\"info-item col-md-6 mb-2\">\r\n-          <span class=\"label d-block\">Adresse:</span>\r\n-          <span class=\"value\">{{ agency?.address || 'N/A' }}</span>\r\n-        </div>\r\n-        <div class=\"info-item col-md-6 mb-2\">\r\n-          <span class=\"label d-block\">Email:</span>\r\n-          <span class=\"value\">{{ agency?.email || 'N/A' }}</span>\r\n-        </div>\r\n-        <div class=\"info-item col-md-6 mb-2\">\r\n-          <span class=\"label d-block\">Téléphone:</span>\r\n-          <span class=\"value\">{{ agency?.phone || 'N/A' }}</span>\r\n-        </div>\r\n-        <div class=\"info-item col-md-6 mb-2\">\r\n-          <span class=\"label d-block\">Date de création:</span>\r\n-          <span class=\"value\">{{ agency?.createdAt | date:'dd/MM/yyyy HH:mm' }}</span> <!-- Ajout heure -->\r\n-        </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Email:</span>\r\n+        <span class=\"value\">{{ agency.email || 'N/A' }}</span>\r\n       </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Téléphone:</span>\r\n+        <span class=\"value\">{{ agency.phone || 'N/A' }}</span>\r\n+      </div>\r\n+      <div class=\"info-item\">\r\n+        <span class=\"label\">Date de création:</span>\r\n+        <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n+      </div>\r\n     </div>\r\n   </div>\r\n \r\n-  <!-- Section Utilisateurs -->\r\n-  <div class=\"users-section card\"> <!-- Utilisation de classes Bootstrap card -->\r\n-    <div class=\"card-body\">\r\n-      <div class=\"users-header d-flex justify-content-between align-items-center mb-3\">\r\n-        <h3 class=\"mb-0\">Utilisateurs</h3>\r\n-        <button mat-flat-button color=\"accent\" class=\"add-user-btn\" (click)=\"addUser()\" [disabled]=\"isLoadingUsers || !!editingUserId\"> <!-- Utiliser mat-flat-button, désactiver si édition -->\r\n-          <mat-icon>person_add</mat-icon> Ajouter Utilisateur <!-- Utiliser mat-icon -->\r\n-        </button>\r\n-      </div>\r\n+  <div class=\"users-section\">\r\n+    <div class=\"users-header\">\r\n+      <h3>Utilisateurs</h3>\r\n+      <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n+        <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n+      </button>\r\n+    </div>\r\n \r\n-      <!-- Indicateur de chargement des utilisateurs -->\r\n-      <div *ngIf=\"isLoadingUsers\" class=\"text-center my-4\">\r\n-        <mat-progress-spinner mode=\"indeterminate\" diameter=\"40\"></mat-progress-spinner> <!-- Utiliser mat-progress-spinner -->\r\n-        <p class=\"mt-2\">Chargement des utilisateurs...</p>\r\n-      </div>\r\n+    <!-- ... début du template ... -->\r\n \r\n-      <!-- Tableau des utilisateurs -->\r\n-      <div class=\"users-table table-responsive\" *ngIf=\"!isLoadingUsers\"> <!-- table-responsive pour petits écrans -->\r\n-        <table class=\"table table-hover\"> <!-- Utilisation de classes Bootstrap table -->\r\n-          <thead>\r\n-            <tr>\r\n-              <th class=\"text-center\">Nom</th>\r\n-              <th class=\"text-center\">Email</th>\r\n-              <th class=\"text-center\">Rôle</th>\r\n-              <th class=\"text-center\">Statut</th>\r\n-              <th class=\"actions-header text-center\">Actions</th>\r\n-            </tr>\r\n-          </thead>\r\n-          <tbody>\r\n-            <!-- Message si aucun utilisateur -->\r\n+    <div class=\"users-table\">\r\n+      <table>\r\n+        <thead>\r\n+          <tr>\r\n+            <th class=\"text-center\">Nom</th>\r\n+            <th class=\"text-center\">Email</th>\r\n+            <th class=\"text-center\">Rôle</th>\r\n+            <th class=\"text-center\">Statut</th> <!-- Header reste le même -->\r\n+            <th class=\"actions-header text-center\">Actions</th>\r\n+          </tr>\r\n+        </thead>\r\n+        <tbody>\r\n+          <!-- Loading Indicator -->\r\n+          <tr *ngIf=\"isLoadingUsers\">\r\n+            <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n+          </tr>\r\n+\r\n+          <!-- User Rows -->\r\n+          <ng-container *ngIf=\"users.length > 0\">\r\n+            <!-- No Users Found Row -->\r\n             <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <td colspan=\"5\" class=\"text-center no-users py-4\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n             </tr>\r\n+            <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n-            <!-- Lignes des utilisateurs -->\r\n-            <tr *ngFor=\"let user of users\" [class.table-info]=\"editingUserId === user.id\"> <!-- Classe Bootstrap pour ligne éditée -->\r\n-\r\n-              <!-- Colonne Nom -->\r\n-              <td class=\"text-center align-middle\"> <!-- align-middle pour alignement vertical -->\r\n+              <!-- Username Column -->\r\n+              <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"form-control form-control-sm inline-edit-input\" /> <!-- form-control Bootstrap -->\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n-              <!-- Colonne Email -->\r\n-              <td class=\"text-center align-middle\">\r\n+              <!-- Email Column -->\r\n+              <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"form-control form-control-sm inline-edit-input\" />\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n-              <!-- Colonne Rôle (Lecture seule) -->\r\n-              <td class=\"text-center align-middle\">{{ user.role }}</td>\r\n+              <!-- Role Column (Read-only) -->\r\n+              <td class=\"text-center\">{{ user.role }}</td>\r\n \r\n-              <!-- Colonne Statut -->\r\n-              <td class=\"status-cell text-center align-middle\">\r\n-                <!-- Mode Affichage: Badge -->\r\n+              <!-- Status Column -->\r\n+              <td class=\"status-cell text-center\">\r\n+                <!-- Display Mode: Badge -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                  <span class=\"badge rounded-pill\" [ngClass]=\"user.enabled ? 'text-bg-success' : 'text-bg-danger'\"> <!-- Badges Bootstrap -->\r\n-                    <i class=\"bi me-1\" [ngClass]=\"user.enabled ? 'bi-check-circle-fill' : 'bi-x-circle-fill'\"></i>\r\n-                    {{ user.enabled ? 'Activé' : 'Désactivé' }}\r\n+                  <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n+                    <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n                   </span>\r\n+                  <span *ngIf=\"!user.enabled\" class=\"status-badge status-disabled\">\r\n+                    <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n+                  </span>\r\n                 </ng-container>\r\n-                <!-- Mode Édition: Toggle Switch Bootstrap -->\r\n+\r\n+                <!-- Edit Mode: Toggle Switch -->\r\n                 <div *ngIf=\"editingUserId === user.id\" class=\"form-check form-switch d-flex justify-content-center align-items-center h-100\">\r\n                   <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n                          id=\"userStatusSwitch-{{user.id}}\"\r\n                          [(ngModel)]=\"editedUserData.enabled\"\r\n-                         [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver' : 'Activer'\">\r\n+                         [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n+                 \r\n                 </div>\r\n               </td>\r\n \r\n-              <!-- Colonne Actions -->\r\n-              <td class=\"actions text-center align-middle\">\r\n-                <!-- Boutons Mode Affichage/Édition -->\r\n+\r\n+              <!-- Actions Column -->\r\n+              <td class=\"actions text-center\">\r\n+                <!-- View/Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                 <button mat-icon-button color=\"primary\" class=\"edit-btn\" (click)=\"editUser(user)\" matTooltip=\"Modifier\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Utiliser mat-icon-button -->\r\n-                   <mat-icon>edit</mat-icon>\r\n+                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                   <i class=\"bi bi-pencil\"></i>\r\n                  </button>\r\n-                 <button mat-icon-button color=\"warn\" class=\"delete-btn\" (click)=\"deleteUser(user)\" matTooltip=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\">\r\n-                    <mat-icon *ngIf=\"isDeletingUser !== user.id\">delete_outline</mat-icon>\r\n-                    <mat-spinner *ngIf=\"isDeletingUser === user.id\" [diameter]=\"20\"></mat-spinner> <!-- Utiliser mat-spinner -->\r\n+                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Disable delete also when editing any user -->\r\n+                    <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n+                    <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                  </button>\r\n                </ng-container>\r\n \r\n-               <!-- Boutons Mode Sauvegarde/Annulation -->\r\n+               <!-- Edit Mode Buttons -->\r\n                <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                 <button mat-icon-button color=\"accent\" class=\"save-btn\" (click)=\"saveUser()\" matTooltip=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n-                   <mat-icon *ngIf=\"!isSavingUser\">check</mat-icon>\r\n-                   <mat-spinner *ngIf=\"isSavingUser\" [diameter]=\"20\"></mat-spinner>\r\n+                 <!-- **** THIS IS THE IMPORTANT CHANGE **** -->\r\n+                 <button class=\"save-btn\" (click)=\"saveUser()\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                 <!-- **** END OF IMPORTANT CHANGE **** -->\r\n+                   <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n+                   <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                  </button>\r\n-                 <button mat-icon-button class=\"cancel-btn\" (click)=\"cancelEdit()\" matTooltip=\"Annuler\" [disabled]=\"isSavingUser\">\r\n-                   <mat-icon>close</mat-icon>\r\n+                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                   <i class=\"bi bi-x-lg\"></i>\r\n                  </button>\r\n                </ng-container>\r\n              </td>\r\n            </tr>\r\n-          </tbody>\r\n-        </table>\r\n-      </div>\r\n+\r\n+<!-- ... rest of the template ... -->\r\n+\r\n+\r\n+            \r\n+          </ng-container>\r\n+\r\n+        </tbody>\r\n+      </table>\r\n     </div>\r\n+\r\n+<!-- ... reste du template ... -->\r\n+\r\n   </div>\r\n </div>\r\n"
                },
                {
                    "date": 1745531439508,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,88 +1,103 @@\n <div class=\"agency-details-container\">\r\n+  <!-- Bouton Fermer (Utilise NgbActiveModal via la méthode closeModal) -->\r\n   <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n     <i class=\"bi bi-x\"></i>\r\n   </button>\r\n+\r\n+  <!-- Section Informations Agence -->\r\n   <div class=\"agency-info\">\r\n     <div class=\"header-section\">\r\n-      <h2>{{ agency.name }}</h2>\r\n+      <h2>{{ agency?.name }}</h2> <!-- Utilisation de '?' pour la sécurité -->\r\n       <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n         <i class=\"bi bi-folder\"></i> Voir Projets\r\n       </button>\r\n     </div>\r\n     <div class=\"info-grid\">\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Adresse:</span>\r\n-        <span class=\"value\">{{ agency.address || 'N/A' }}</span>\r\n+        <!-- Utilisation de '?' et fallback 'N/A' -->\r\n+        <span class=\"value\">{{ agency?.address || 'N/A' }}</span>\r\n       </div>\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Email:</span>\r\n-        <span class=\"value\">{{ agency.email || 'N/A' }}</span>\r\n+        <span class=\"value\">{{ agency?.email || 'N/A' }}</span>\r\n       </div>\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Téléphone:</span>\r\n-        <span class=\"value\">{{ agency.phone || 'N/A' }}</span>\r\n+        <span class=\"value\">{{ agency?.phone || 'N/A' }}</span>\r\n       </div>\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Date de création:</span>\r\n-        <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n+        <!-- Le pipe date gère null/undefined -->\r\n+        <span class=\"value\">{{ agency?.createdAt | date:'dd/MM/yyyy' }}</span>\r\n       </div>\r\n     </div>\r\n   </div>\r\n \r\n+  <!-- Section Utilisateurs -->\r\n   <div class=\"users-section\">\r\n     <div class=\"users-header\">\r\n       <h3>Utilisateurs</h3>\r\n+      <!-- Le bouton Ajouter appelle addUser avec l'agence actuelle -->\r\n       <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n         <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n       </button>\r\n     </div>\r\n \r\n-    <!-- ... début du template ... -->\r\n-\r\n     <div class=\"users-table\">\r\n       <table>\r\n         <thead>\r\n           <tr>\r\n             <th class=\"text-center\">Nom</th>\r\n             <th class=\"text-center\">Email</th>\r\n             <th class=\"text-center\">Rôle</th>\r\n-            <th class=\"text-center\">Statut</th> <!-- Header reste le même -->\r\n+            <th class=\"text-center\">Statut</th>\r\n             <th class=\"actions-header text-center\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n-          <!-- Loading Indicator -->\r\n+          <!-- Indicateur de Chargement -->\r\n           <tr *ngIf=\"isLoadingUsers\">\r\n-            <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n+            <td colspan=\"5\" class=\"loading-state text-center\">\r\n+                <!-- Optionnel: Ajouter un spinner ici -->\r\n+                <span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n+                Chargement des utilisateurs...\r\n+            </td>\r\n           </tr>\r\n \r\n-          <!-- User Rows -->\r\n-          <ng-container *ngIf=\"users.length > 0\">\r\n-            <!-- No Users Found Row -->\r\n-            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n-            </tr>\r\n+          <!-- Message Aucun Utilisateur -->\r\n+          <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n+            <td colspan=\"5\" class=\"no-users text-center\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+          </tr>\r\n+\r\n+          <!-- Lignes Utilisateurs (si non en chargement et si des utilisateurs existent) -->\r\n+          <ng-container *ngIf=\"!isLoadingUsers && users.length > 0\">\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n-              <!-- Username Column -->\r\n+              <!-- Colonne Nom -->\r\n               <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n+                <!-- Mode édition: Input avec ngModel -->\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" placeholder=\"Nom d'utilisateur\" />\r\n               </td>\r\n \r\n-              <!-- Email Column -->\r\n+              <!-- Colonne Email -->\r\n               <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n+                <!-- Mode édition: Input avec ngModel -->\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" placeholder=\"Email\" />\r\n               </td>\r\n \r\n-              <!-- Role Column (Read-only) -->\r\n-              <td class=\"text-center\">{{ user.role }}</td>\r\n+              <!-- Colonne Rôle (Lecture seule) -->\r\n+              <td class=\"text-center\">\r\n+                  <!-- Affichage du rôle, potentiellement avec un badge -->\r\n+                  <span class=\"role-badge\" [ngClass]=\"'role-' + (user.role?.toLowerCase() || 'user')\">{{ user.role || 'N/A' }}</span>\r\n+              </td>\r\n \r\n-              <!-- Status Column -->\r\n+              <!-- Colonne Statut -->\r\n               <td class=\"status-cell text-center\">\r\n-                <!-- Display Mode: Badge -->\r\n+                <!-- Mode Affichage: Badges -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                   <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n                     <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n                   </span>\r\n@@ -90,57 +105,49 @@\n                     <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n                   </span>\r\n                 </ng-container>\r\n \r\n-                <!-- Edit Mode: Toggle Switch -->\r\n+                <!-- Mode Édition: Toggle Switch Bootstrap -->\r\n                 <div *ngIf=\"editingUserId === user.id\" class=\"form-check form-switch d-flex justify-content-center align-items-center h-100\">\r\n                   <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n                          id=\"userStatusSwitch-{{user.id}}\"\r\n                          [(ngModel)]=\"editedUserData.enabled\"\r\n                          [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n-                 \r\n                 </div>\r\n               </td>\r\n \r\n-\r\n-              <!-- Actions Column -->\r\n+              <!-- Colonne Actions -->\r\n               <td class=\"actions text-center\">\r\n-                <!-- View/Edit Mode Buttons -->\r\n+                <!-- Boutons Mode Affichage -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n+                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\"\r\n+                         [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Désactivé si un autre est en édition OU si celui-ci est en suppression -->\r\n                    <i class=\"bi bi-pencil\"></i>\r\n                  </button>\r\n-                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Disable delete also when editing any user -->\r\n+                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\"\r\n+                         [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Désactivé si un autre est en édition OU si celui-ci est en suppression -->\r\n                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n+                    <!-- Spinner pendant la suppression -->\r\n                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                  </button>\r\n                </ng-container>\r\n \r\n-               <!-- Edit Mode Buttons -->\r\n+               <!-- Boutons Mode Édition -->\r\n                <ng-container *ngIf=\"editingUserId === user.id\">\r\n-                 <!-- **** THIS IS THE IMPORTANT CHANGE **** -->\r\n                  <button class=\"save-btn\" (click)=\"saveUser()\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n-                 <!-- **** END OF IMPORTANT CHANGE **** -->\r\n                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n+                   <!-- Spinner pendant la sauvegarde -->\r\n                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                  </button>\r\n-                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n+                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\"> <!-- Désactivé pendant la sauvegarde -->\r\n                    <i class=\"bi bi-x-lg\"></i>\r\n                  </button>\r\n                </ng-container>\r\n              </td>\r\n            </tr>\r\n+          </ng-container> <!-- Fin ng-container pour les lignes utilisateurs -->\r\n \r\n-<!-- ... rest of the template ... -->\r\n-\r\n-\r\n-            \r\n-          </ng-container>\r\n-\r\n         </tbody>\r\n       </table>\r\n     </div>\r\n-\r\n-<!-- ... reste du template ... -->\r\n-\r\n   </div>\r\n </div>\r\n"
                },
                {
                    "date": 1745531453239,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,103 +1,88 @@\n <div class=\"agency-details-container\">\r\n-  <!-- Bouton Fermer (Utilise NgbActiveModal via la méthode closeModal) -->\r\n   <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n     <i class=\"bi bi-x\"></i>\r\n   </button>\r\n-\r\n-  <!-- Section Informations Agence -->\r\n   <div class=\"agency-info\">\r\n     <div class=\"header-section\">\r\n-      <h2>{{ agency?.name }}</h2> <!-- Utilisation de '?' pour la sécurité -->\r\n+      <h2>{{ agency.name }}</h2>\r\n       <button mat-button class=\"projects-btn\" (click)=\"viewProjects()\">\r\n         <i class=\"bi bi-folder\"></i> Voir Projets\r\n       </button>\r\n     </div>\r\n     <div class=\"info-grid\">\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Adresse:</span>\r\n-        <!-- Utilisation de '?' et fallback 'N/A' -->\r\n-        <span class=\"value\">{{ agency?.address || 'N/A' }}</span>\r\n+        <span class=\"value\">{{ agency.address || 'N/A' }}</span>\r\n       </div>\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Email:</span>\r\n-        <span class=\"value\">{{ agency?.email || 'N/A' }}</span>\r\n+        <span class=\"value\">{{ agency.email || 'N/A' }}</span>\r\n       </div>\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Téléphone:</span>\r\n-        <span class=\"value\">{{ agency?.phone || 'N/A' }}</span>\r\n+        <span class=\"value\">{{ agency.phone || 'N/A' }}</span>\r\n       </div>\r\n       <div class=\"info-item\">\r\n         <span class=\"label\">Date de création:</span>\r\n-        <!-- Le pipe date gère null/undefined -->\r\n-        <span class=\"value\">{{ agency?.createdAt | date:'dd/MM/yyyy' }}</span>\r\n+        <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n       </div>\r\n     </div>\r\n   </div>\r\n \r\n-  <!-- Section Utilisateurs -->\r\n   <div class=\"users-section\">\r\n     <div class=\"users-header\">\r\n       <h3>Utilisateurs</h3>\r\n-      <!-- Le bouton Ajouter appelle addUser avec l'agence actuelle -->\r\n       <button mat-button class=\"add-user-btn\" (click)=\"addUser(agency)\">\r\n         <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n       </button>\r\n     </div>\r\n \r\n+    <!-- ... début du template ... -->\r\n+\r\n     <div class=\"users-table\">\r\n       <table>\r\n         <thead>\r\n           <tr>\r\n             <th class=\"text-center\">Nom</th>\r\n             <th class=\"text-center\">Email</th>\r\n             <th class=\"text-center\">Rôle</th>\r\n-            <th class=\"text-center\">Statut</th>\r\n+            <th class=\"text-center\">Statut</th> <!-- Header reste le même -->\r\n             <th class=\"actions-header text-center\">Actions</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n-          <!-- Indicateur de Chargement -->\r\n+          <!-- Loading Indicator -->\r\n           <tr *ngIf=\"isLoadingUsers\">\r\n-            <td colspan=\"5\" class=\"loading-state text-center\">\r\n-                <!-- Optionnel: Ajouter un spinner ici -->\r\n-                <span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n-                Chargement des utilisateurs...\r\n-            </td>\r\n+            <td colspan=\"5\" class=\"loading-state\">Chargement des utilisateurs...</td>\r\n           </tr>\r\n \r\n-          <!-- Message Aucun Utilisateur -->\r\n-          <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n-            <td colspan=\"5\" class=\"no-users text-center\">Aucun utilisateur trouvé pour cette agence.</td>\r\n-          </tr>\r\n-\r\n-          <!-- Lignes Utilisateurs (si non en chargement et si des utilisateurs existent) -->\r\n-          <ng-container *ngIf=\"!isLoadingUsers && users.length > 0\">\r\n+          <!-- User Rows -->\r\n+          <ng-container *ngIf=\"users.length > 0\">\r\n+            <!-- No Users Found Row -->\r\n+            <tr *ngIf=\"!isLoadingUsers && users.length === 0\">\r\n+              <td colspan=\"5\" class=\"no-users\">Aucun utilisateur trouvé pour cette agence.</td>\r\n+            </tr>\r\n             <tr *ngFor=\"let user of users\" [class.editing-row]=\"editingUserId === user.id\">\r\n \r\n-              <!-- Colonne Nom -->\r\n+              <!-- Username Column -->\r\n               <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.username }}</span>\r\n-                <!-- Mode édition: Input avec ngModel -->\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" placeholder=\"Nom d'utilisateur\" />\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"text\" [(ngModel)]=\"editedUserData.username\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n-              <!-- Colonne Email -->\r\n+              <!-- Email Column -->\r\n               <td class=\"text-center\">\r\n                 <span *ngIf=\"editingUserId !== user.id\">{{ user.email }}</span>\r\n-                <!-- Mode édition: Input avec ngModel -->\r\n-                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" placeholder=\"Email\" />\r\n+                <input *ngIf=\"editingUserId === user.id\" type=\"email\" [(ngModel)]=\"editedUserData.email\" class=\"inline-edit-input\" />\r\n               </td>\r\n \r\n-              <!-- Colonne Rôle (Lecture seule) -->\r\n-              <td class=\"text-center\">\r\n-                  <!-- Affichage du rôle, potentiellement avec un badge -->\r\n-                  <span class=\"role-badge\" [ngClass]=\"'role-' + (user.role?.toLowerCase() || 'user')\">{{ user.role || 'N/A' }}</span>\r\n-              </td>\r\n+              <!-- Role Column (Read-only) -->\r\n+              <td class=\"text-center\">{{ user.role }}</td>\r\n \r\n-              <!-- Colonne Statut -->\r\n+              <!-- Status Column -->\r\n               <td class=\"status-cell text-center\">\r\n-                <!-- Mode Affichage: Badges -->\r\n+                <!-- Display Mode: Badge -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n                   <span *ngIf=\"user.enabled\" class=\"status-badge status-enabled\">\r\n                     <i class=\"bi bi-check-circle-fill\"></i> Activé\r\n                   </span>\r\n@@ -105,49 +90,57 @@\n                     <i class=\"bi bi-x-circle-fill\"></i> Désactivé\r\n                   </span>\r\n                 </ng-container>\r\n \r\n-                <!-- Mode Édition: Toggle Switch Bootstrap -->\r\n+                <!-- Edit Mode: Toggle Switch -->\r\n                 <div *ngIf=\"editingUserId === user.id\" class=\"form-check form-switch d-flex justify-content-center align-items-center h-100\">\r\n                   <input class=\"form-check-input\" type=\"checkbox\" role=\"switch\"\r\n                          id=\"userStatusSwitch-{{user.id}}\"\r\n                          [(ngModel)]=\"editedUserData.enabled\"\r\n                          [attr.aria-label]=\"editedUserData.enabled ? 'Désactiver l\\'utilisateur' : 'Activer l\\'utilisateur'\">\r\n+                 \r\n                 </div>\r\n               </td>\r\n \r\n-              <!-- Colonne Actions -->\r\n+\r\n+              <!-- Actions Column -->\r\n               <td class=\"actions text-center\">\r\n-                <!-- Boutons Mode Affichage -->\r\n+                <!-- View/Edit Mode Buttons -->\r\n                 <ng-container *ngIf=\"editingUserId !== user.id\">\r\n-                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\"\r\n-                         [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Désactivé si un autre est en édition OU si celui-ci est en suppression -->\r\n+                 <button class=\"edit-btn\" (click)=\"editUser(user)\" title=\"Modifier\" [disabled]=\"isDeletingUser === user.id\">\r\n                    <i class=\"bi bi-pencil\"></i>\r\n                  </button>\r\n-                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\"\r\n-                         [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Désactivé si un autre est en édition OU si celui-ci est en suppression -->\r\n+                 <button class=\"delete-btn\" (click)=\"deleteUser(user)\" title=\"Supprimer\" [disabled]=\"isDeletingUser === user.id || !!editingUserId\"> <!-- Disable delete also when editing any user -->\r\n                     <i *ngIf=\"isDeletingUser !== user.id\" class=\"bi bi-trash\"></i>\r\n-                    <!-- Spinner pendant la suppression -->\r\n                     <span *ngIf=\"isDeletingUser === user.id\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                  </button>\r\n                </ng-container>\r\n \r\n-               <!-- Boutons Mode Édition -->\r\n+               <!-- Edit Mode Buttons -->\r\n                <ng-container *ngIf=\"editingUserId === user.id\">\r\n+                 <!-- **** THIS IS THE IMPORTANT CHANGE **** -->\r\n                  <button class=\"save-btn\" (click)=\"saveUser()\" title=\"Enregistrer\" [disabled]=\"isSavingUser\">\r\n+                 <!-- **** END OF IMPORTANT CHANGE **** -->\r\n                    <i *ngIf=\"!isSavingUser\" class=\"bi bi-check-lg\"></i>\r\n-                   <!-- Spinner pendant la sauvegarde -->\r\n                    <span *ngIf=\"isSavingUser\" class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span>\r\n                  </button>\r\n-                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\"> <!-- Désactivé pendant la sauvegarde -->\r\n+                 <button class=\"cancel-btn\" (click)=\"cancelEdit()\" title=\"Annuler\" [disabled]=\"isSavingUser\">\r\n                    <i class=\"bi bi-x-lg\"></i>\r\n                  </button>\r\n                </ng-container>\r\n              </td>\r\n            </tr>\r\n-          </ng-container> <!-- Fin ng-container pour les lignes utilisateurs -->\r\n \r\n+<!-- ... rest of the template ... -->\r\n+\r\n+\r\n+            \r\n+          </ng-container>\r\n+\r\n         </tbody>\r\n       </table>\r\n     </div>\r\n+\r\n+<!-- ... reste du template ... -->\r\n+\r\n   </div>\r\n </div>\r\n"
                },
                {
                    "date": 1745531459729,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n <div class=\"agency-details-container\">\r\n-  <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n+  <button class=\"close-modal-btn\"  aria-label=\"Fermer\">\r\n     <i class=\"bi bi-x\"></i>\r\n   </button>\r\n   <div class=\"agency-info\">\r\n     <div class=\"header-section\">\r\n"
                },
                {
                    "date": 1745531898360,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n <div class=\"agency-details-container\">\r\n-  <button class=\"close-modal-btn\"  aria-label=\"Fermer\">\r\n+  <button class=\"close-modal-btn\" (click)=\"closeModal()\" aria-label=\"Fermer\">\r\n     <i class=\"bi bi-x\"></i>\r\n   </button>\r\n   <div class=\"agency-info\">\r\n     <div class=\"header-section\">\r\n"
                }
            ],
            "date": 1744030048029,
            "name": "Commit-0",
            "content": "<div class=\"agency-details-container\">\r\n    <div class=\"agency-info\">\r\n      <h2>{{ agency.name }}</h2>\r\n      <div class=\"info-grid\">\r\n        <div class=\"info-item\">\r\n          <span class=\"label\">Adresse:</span>\r\n          <span class=\"value\">{{ agency.address }}</span>\r\n        </div>\r\n        <div class=\"info-item\">\r\n          <span class=\"label\">Email:</span>\r\n          <span class=\"value\">{{ agency.email }}</span>\r\n        </div>\r\n        <div class=\"info-item\">\r\n          <span class=\"label\">Téléphone:</span>\r\n          <span class=\"value\">{{ agency.phone }}</span>\r\n        </div>\r\n        <div class=\"info-item\">\r\n          <span class=\"label\">Date de création:</span>\r\n          <span class=\"value\">{{ agency.createdAt | date:'dd/MM/yyyy' }}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  \r\n    <div class=\"users-section\">\r\n      <div class=\"users-header\">\r\n        <h3>Utilisateurs</h3>\r\n        <button mat-button class=\"add-user-btn\" (click)=\"addUser()\">\r\n          <i class=\"bi bi-plus\"></i> Ajouter Utilisateur\r\n        </button>\r\n      </div>\r\n  \r\n      <div class=\"users-table\">\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>Nom</th>\r\n              <th>Email</th>\r\n              <th>Rôle</th>\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr *ngFor=\"let user of users\">\r\n              <td>{{ user.name }}</td>\r\n              <td>{{ user.email }}</td>\r\n              <td>{{ user.role }}</td>\r\n              <td class=\"actions\">\r\n                <button class=\"delete-btn\" (click)=\"deleteUser(user)\"><i class=\"bi bi-trash\"></i></button>\r\n              </td>\r\n            </tr>\r\n            <tr *ngIf=\"users.length === 0\">\r\n              <td colspan=\"4\" class=\"no-users\">Aucun utilisateur trouvé</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>"
        }
    ]
}